VERSION 5.00
Object = "{4832871B-0993-461C-B983-0EAAA4A43E5C}#5.0#0"; "SftTabs_IX86_U_50.ocx"
Begin VB.Form frmBars 
   BackColor       =   &H00000000&
   BorderStyle     =   0  'None
   Caption         =   "CWT Desktop - CWT Toolbar"
   ClientHeight    =   795
   ClientLeft      =   735
   ClientTop       =   2250
   ClientWidth     =   15360
   Icon            =   "frmBars.frx":0000
   LinkTopic       =   "Form1"
   Picture         =   "frmBars.frx":527A
   ScaleHeight     =   795
   ScaleWidth      =   15360
   ShowInTaskbar   =   0   'False
   Begin SftTabsLib.SftTabs SftTabs 
      Height          =   735
      Left            =   0
      TabIndex        =   0
      Top             =   60
      Width           =   15360
      PropVer         =   50
      xcx             =   27093
      xcy             =   1296
      PropFile        =   ""
      PropDesignTime  =   1
      DeletePropFile  =   0
      IntVal          =   55
      xBfStyle1       =   63838276
      xBfStyle2       =   1951095935
      xBfStyle3       =   1904034875
      xBfStyle4       =   -1635599419
      TabCount        =   7
      CurrentTab      =   4
      FlatProperties  =   0   'False
      BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         Text            =   " Air  "
         ToolTip         =   "Air"
         Object.Align           =   7
         BackColor       =   -1
         BackColorActive =   -1
         ClientAreaColor =   -1
         Enabled         =   1
         FlyByColor      =   6973442
         ForeColor       =   -1
         ForeColorActive =   -1
         Picture         =   "frmBars.frx":39F5C
         Name            =   ""
         Hidden          =   0
         BackColorStart  =   -1
         BackColorEnd    =   -1
         BackColorActiveStart=   -1
         BackColorActiveEnd=   -1
         ClientAreaColorStart=   -1
         ClientAreaColorEnd=   -1
      EndProperty
      BeginProperty Tab(1) {48328725-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         Text            =   " Hotel  "
         ToolTip         =   "Hotel"
         Object.Align           =   7
         BackColor       =   -1
         BackColorActive =   -1
         ClientAreaColor =   -1
         Enabled         =   1
         FlyByColor      =   6973442
         ForeColor       =   -1
         ForeColorActive =   -1
         Picture         =   "frmBars.frx":3A322
         Name            =   ""
         Hidden          =   0
         BackColorStart  =   -1
         BackColorEnd    =   -1
         BackColorActiveStart=   -1
         BackColorActiveEnd=   -1
         ClientAreaColorStart=   -1
         ClientAreaColorEnd=   -1
      EndProperty
      BeginProperty Tab(2) {48328725-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         Text            =   " Car "
         ToolTip         =   "Car"
         Object.Align           =   7
         BackColor       =   -1
         BackColorActive =   -1
         ClientAreaColor =   -1
         Enabled         =   1
         FlyByColor      =   6973442
         ForeColor       =   -1
         ForeColorActive =   -1
         Picture         =   "frmBars.frx":3A6E8
         Name            =   ""
         Hidden          =   0
         BackColorStart  =   -1
         BackColorEnd    =   -1
         BackColorActiveStart=   -1
         BackColorActiveEnd=   -1
         ClientAreaColorStart=   -1
         ClientAreaColorEnd=   -1
      EndProperty
      BeginProperty Tab(3) {48328725-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         Text            =   " Other Services "
         ToolTip         =   ""
         Object.Align           =   7
         BackColor       =   -1
         BackColorActive =   -1
         ClientAreaColor =   -1
         Enabled         =   1
         FlyByColor      =   6973442
         ForeColor       =   -1
         ForeColorActive =   -1
         Picture         =   "frmBars.frx":3AAAE
         Name            =   ""
         Hidden          =   0
         BackColorStart  =   -1
         BackColorEnd    =   -1
         BackColorActiveStart=   -1
         BackColorActiveEnd=   -1
         ClientAreaColorStart=   -1
         ClientAreaColorEnd=   -1
      EndProperty
      BeginProperty Tab(4) {48328725-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         Text            =   "Add-Ins Tool"
         ToolTip         =   ""
         Object.Align           =   7
         BackColor       =   -1
         BackColorActive =   -1
         ClientAreaColor =   -1
         Enabled         =   1
         FlyByColor      =   6973442
         ForeColor       =   -1
         ForeColorActive =   -1
         Picture         =   "frmBars.frx":3AEA8
         Name            =   ""
         Hidden          =   0
         BackColorStart  =   -1
         BackColorEnd    =   -1
         BackColorActiveStart=   -1
         BackColorActiveEnd=   -1
         ClientAreaColorStart=   -1
         ClientAreaColorEnd=   -1
      EndProperty
      BeginProperty Tab(5) {48328725-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         Text            =   "Touch Tracking"
         ToolTip         =   ""
         Object.Align           =   0
         BackColor       =   -1
         BackColorActive =   -1
         ClientAreaColor =   -1
         Enabled         =   1
         FlyByColor      =   6973442
         ForeColor       =   -1
         ForeColorActive =   -1
         Name            =   ""
         Hidden          =   0
         BackColorStart  =   -1
         BackColorEnd    =   -1
         BackColorActiveStart=   -1
         BackColorActiveEnd=   -1
         ClientAreaColorStart=   -1
         ClientAreaColorEnd=   -1
      EndProperty
      BeginProperty Tab(6) {48328725-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         Text            =   "Aqua Itin Rmk"
         ToolTip         =   ""
         Object.Align           =   0
         BackColor       =   -1
         BackColorActive =   -1
         ClientAreaColor =   -1
         Enabled         =   1
         FlyByColor      =   6973442
         ForeColor       =   -1
         ForeColorActive =   -1
         Name            =   ""
         Hidden          =   0
         BackColorStart  =   -1
         BackColorEnd    =   -1
         BackColorActiveStart=   -1
         BackColorActiveEnd=   -1
         ClientAreaColorStart=   -1
         ClientAreaColorEnd=   -1
      EndProperty
      BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
      EndProperty
      BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
         PropVer         =   0
         ToolTipCloseButton=   "Close"
         ToolTipLeftButton=   "Scroll Left/Up"
         ToolTipRightButton=   "Scroll Right/Down"
         ToolTipRestoreButton=   "Restore"
         ToolTipMinimizeButton=   "Minimize"
      EndProperty
      Appearance      =   1
      BackgroundInside=   "frmBars.frx":3B184
      ClientArea      =   1
      Enabled         =   1
      FlatProperties  =   0
      MousePointer    =   0
      OLEDragMode     =   0
      OLEDropMode     =   0
      Style           =   60
      UseClientAreaColors=   0
      BackColor       =   -2147483626
      BorderColor     =   6973442
      BrightHighlightColor=   -2147483628
      ForeColor       =   0
      HighlightColor  =   -2147483626
      ShadowColor     =   -2147483632
      ScrollingButtonBackColor=   -2147483633
      ScrollingButtonBorderColor=   -2147483627
      ScrollingButtonForeColor=   -2147483630
      ScrollingButtonForeColorGrayed=   -2147483630
      ScrollingButtonHighlightColor=   -2147483628
      ScrollingButtonShadowColor=   -2147483632
      TabsBoldActive  =   1
      TabsDropText    =   0
      TabsEachRow     =   0
      TabsFillComplete=   0
      TabsFixed       =   0
      TabsFlyby       =   1
      TabsRows        =   1
      TabsRowIndent   =   -1
      TabsTextOnly    =   0
      TabsLeftMargin  =   0
      TabsRightMargin =   0
      ScrollButtonStyle=   5
      ScrollCondScrollButtons=   0
      ScrollFullSize  =   1
      ScrollHideScrollButtons=   0
      ScrollNoTruncate=   0
      ScrollScrollable=   0
      ScrollScrollOnLeft=   0
      AlwaysShowAccel =   0
      UseExactRegion  =   1
      UseThemes       =   -1  'True
      ShowFocusRectangle=   1
      ButtonAlignment =   0
      CloseButton     =   0
      CloseButtonDisabled=   0
      CloseButtonWMCLOSE=   1
      CloseButtonFullSize=   0
      CloseButtonAlignment=   0
      MinimizeButton  =   0
      RestoreButton   =   0
      CustomCode      =   0
      xDesign         =   30
      yDesign         =   360
      List(0)Count    =   1
      List(0)(0)Ctl   =   "SftSubTabs(0)"
      List(0)(0)Ena   =   -1
      List(0)(0)x     =   0
      List(0)(0)y     =   330
      List(1)Count    =   1
      List(1)(0)Ctl   =   "SftSubTabs(1)"
      List(1)(0)Ena   =   -1
      List(1)(0)x     =   0
      List(1)(0)y     =   345
      List(2)Count    =   1
      List(2)(0)Ctl   =   "SftSubTabs(2)"
      List(2)(0)Ena   =   -1
      List(2)(0)x     =   0
      List(2)(0)y     =   330
      List(3)Count    =   1
      List(3)(0)Ctl   =   "SftSubTabs(3)"
      List(3)(0)Ena   =   -1
      List(3)(0)x     =   0
      List(3)(0)y     =   330
      List(4)Count    =   0
      List(5)Count    =   1
      List(5)(0)Ctl   =   "SftSubTabs(5)"
      List(5)(0)Ena   =   -1
      List(5)(0)x     =   0
      List(5)(0)y     =   360
      List(6)Count    =   1
      List(6)(0)Ctl   =   "SftSubTabs(6)"
      List(6)(0)Ena   =   -1
      List(6)(0)x     =   0
      List(6)(0)y     =   360
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin SftTabsLib.SftTabs SftSubTabs 
         Height          =   350
         Index           =   4
         Left            =   0
         TabIndex        =   4
         Top             =   330
         Width           =   15375
         PropVer         =   50
         xcx             =   27120
         xcy             =   609
         PropFile        =   ""
         PropDesignTime  =   1
         DeletePropFile  =   0
         IntVal          =   55
         xBfStyle1       =   63838276
         xBfStyle2       =   1951095935
         xBfStyle3       =   1904034875
         xBfStyle4       =   -1635599419
         TabCount        =   6
         CurrentTab      =   2
         FlatProperties  =   0   'False
         BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hide Search Panel"
            ToolTip         =   ""
            Object.Align           =   7
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Picture         =   "frmBars.frx":6FE76
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(1) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Raise Dispatch/Visa"
            ToolTip         =   ""
            Object.Align           =   7
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Picture         =   "frmBars.frx":702B8
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(2) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Send TKT Reminder"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(3) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "MCO"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(4) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "ETR"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(5) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "WBS"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
         EndProperty
         BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            ToolTipCloseButton=   "Close"
            ToolTipLeftButton=   "Scroll Left/Up"
            ToolTipRightButton=   "Scroll Right/Down"
            ToolTipRestoreButton=   "Restore"
            ToolTipMinimizeButton=   "Minimize"
         EndProperty
         Appearance      =   1
         ClientArea      =   1
         Enabled         =   1
         FlatProperties  =   0
         MousePointer    =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         Style           =   21
         UseClientAreaColors=   0
         BackColor       =   -2147483628
         BorderColor     =   6973442
         BrightHighlightColor=   -2147483628
         ForeColor       =   0
         HighlightColor  =   6973442
         ShadowColor     =   -2147483632
         ScrollingButtonBackColor=   -2147483633
         ScrollingButtonBorderColor=   -2147483627
         ScrollingButtonForeColor=   -2147483630
         ScrollingButtonForeColorGrayed=   -2147483630
         ScrollingButtonHighlightColor=   -2147483628
         ScrollingButtonShadowColor=   -2147483632
         TabsBoldActive  =   1
         TabsDropText    =   0
         TabsEachRow     =   0
         TabsFillComplete=   0
         TabsFixed       =   0
         TabsFlyby       =   1
         TabsRows        =   1
         TabsRowIndent   =   -1
         TabsTextOnly    =   0
         TabsLeftMargin  =   0
         TabsRightMargin =   0
         ScrollButtonStyle=   5
         ScrollCondScrollButtons=   0
         ScrollFullSize  =   1
         ScrollHideScrollButtons=   0
         ScrollNoTruncate=   0
         ScrollScrollable=   0
         ScrollScrollOnLeft=   0
         AlwaysShowAccel =   0
         UseExactRegion  =   1
         UseThemes       =   -1  'True
         ShowFocusRectangle=   1
         ButtonAlignment =   0
         CloseButton     =   0
         CloseButtonDisabled=   0
         CloseButtonWMCLOSE=   1
         CloseButtonFullSize=   0
         CloseButtonAlignment=   0
         MinimizeButton  =   0
         RestoreButton   =   0
         CustomCode      =   0
         xDesign         =   15
         yDesign         =   390
         List(0)Count    =   0
         List(1)Count    =   0
         List(2)Count    =   0
         List(3)Count    =   0
         List(4)Count    =   0
         List(5)Count    =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin SftTabsLib.SftTabs SftSubTabs 
         Height          =   350
         Index           =   3
         Left            =   -16375
         TabIndex        =   3
         Top             =   -1680
         Width           =   15375
         PropVer         =   50
         xcx             =   27120
         xcy             =   609
         PropFile        =   ""
         PropDesignTime  =   1
         DeletePropFile  =   0
         IntVal          =   55
         xBfStyle1       =   63838276
         xBfStyle2       =   1951095935
         xBfStyle3       =   1904034875
         xBfStyle4       =   -1635599419
         TabCount        =   5
         CurrentTab      =   4
         FlatProperties  =   0   'False
         BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hide Search Panel"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(1) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Create ACCT/EO"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(2) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Print EO"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(3) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Update Dispatch/Visa ACCT"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(4) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Approve Cheque"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
         EndProperty
         BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            ToolTipCloseButton=   "Close"
            ToolTipLeftButton=   "Scroll Left/Up"
            ToolTipRightButton=   "Scroll Right/Down"
            ToolTipRestoreButton=   "Restore"
            ToolTipMinimizeButton=   "Minimize"
         EndProperty
         Appearance      =   1
         ClientArea      =   1
         Enabled         =   0
         FlatProperties  =   0
         MousePointer    =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         Style           =   21
         UseClientAreaColors=   0
         BackColor       =   -2147483628
         BorderColor     =   6973442
         BrightHighlightColor=   -2147483628
         ForeColor       =   0
         HighlightColor  =   6973442
         ShadowColor     =   -2147483632
         ScrollingButtonBackColor=   -2147483633
         ScrollingButtonBorderColor=   -2147483627
         ScrollingButtonForeColor=   -2147483630
         ScrollingButtonForeColorGrayed=   -2147483630
         ScrollingButtonHighlightColor=   -2147483628
         ScrollingButtonShadowColor=   -2147483632
         TabsBoldActive  =   1
         TabsDropText    =   0
         TabsEachRow     =   0
         TabsFillComplete=   0
         TabsFixed       =   0
         TabsFlyby       =   1
         TabsRows        =   1
         TabsRowIndent   =   -1
         TabsTextOnly    =   0
         TabsLeftMargin  =   0
         TabsRightMargin =   0
         ScrollButtonStyle=   5
         ScrollCondScrollButtons=   0
         ScrollFullSize  =   1
         ScrollHideScrollButtons=   0
         ScrollNoTruncate=   0
         ScrollScrollable=   0
         ScrollScrollOnLeft=   0
         AlwaysShowAccel =   0
         UseExactRegion  =   1
         UseThemes       =   -1  'True
         ShowFocusRectangle=   1
         ButtonAlignment =   0
         CloseButton     =   0
         CloseButtonDisabled=   0
         CloseButtonWMCLOSE=   1
         CloseButtonFullSize=   0
         CloseButtonAlignment=   0
         MinimizeButton  =   0
         RestoreButton   =   0
         CustomCode      =   0
         xDesign         =   15
         yDesign         =   345
         List(0)Count    =   0
         List(1)Count    =   0
         List(2)Count    =   0
         List(3)Count    =   0
         List(4)Count    =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin SftTabsLib.SftTabs SftSubTabs 
         Height          =   350
         Index           =   2
         Left            =   -16375
         TabIndex        =   2
         Top             =   -1680
         Width           =   15375
         PropVer         =   50
         xcx             =   27120
         xcy             =   609
         PropFile        =   ""
         PropDesignTime  =   1
         DeletePropFile  =   0
         IntVal          =   55
         xBfStyle1       =   63838276
         xBfStyle2       =   1951095935
         xBfStyle3       =   1904034875
         xBfStyle4       =   -1635599419
         TabCount        =   3
         CurrentTab      =   0
         FlatProperties  =   0   'False
         BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hide Search Bar"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(1) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Car Rental"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(2) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Car MI"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
         EndProperty
         BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            ToolTipCloseButton=   "Close"
            ToolTipLeftButton=   "Scroll Left/Up"
            ToolTipRightButton=   "Scroll Right/Down"
            ToolTipRestoreButton=   "Restore"
            ToolTipMinimizeButton=   "Minimize"
         EndProperty
         Appearance      =   1
         ClientArea      =   1
         Enabled         =   0
         FlatProperties  =   0
         MousePointer    =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         Style           =   21
         UseClientAreaColors=   0
         BackColor       =   -2147483628
         BorderColor     =   6973442
         BrightHighlightColor=   -2147483628
         ForeColor       =   0
         HighlightColor  =   6973442
         ShadowColor     =   -2147483632
         ScrollingButtonBackColor=   -2147483633
         ScrollingButtonBorderColor=   -2147483627
         ScrollingButtonForeColor=   -2147483630
         ScrollingButtonForeColorGrayed=   -2147483630
         ScrollingButtonHighlightColor=   -2147483628
         ScrollingButtonShadowColor=   -2147483632
         TabsBoldActive  =   1
         TabsDropText    =   0
         TabsEachRow     =   0
         TabsFillComplete=   0
         TabsFixed       =   0
         TabsFlyby       =   1
         TabsRows        =   1
         TabsRowIndent   =   -1
         TabsTextOnly    =   0
         TabsLeftMargin  =   0
         TabsRightMargin =   0
         ScrollButtonStyle=   5
         ScrollCondScrollButtons=   0
         ScrollFullSize  =   1
         ScrollHideScrollButtons=   0
         ScrollNoTruncate=   0
         ScrollScrollable=   0
         ScrollScrollOnLeft=   0
         AlwaysShowAccel =   0
         UseExactRegion  =   1
         UseThemes       =   -1  'True
         ShowFocusRectangle=   1
         ButtonAlignment =   0
         CloseButton     =   0
         CloseButtonDisabled=   0
         CloseButtonWMCLOSE=   1
         CloseButtonFullSize=   0
         CloseButtonAlignment=   0
         MinimizeButton  =   0
         RestoreButton   =   0
         CustomCode      =   0
         xDesign         =   15
         yDesign         =   345
         List(0)Count    =   0
         List(1)Count    =   0
         List(2)Count    =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin SftTabsLib.SftTabs SftSubTabs 
         Height          =   350
         Index           =   0
         Left            =   -16375
         TabIndex        =   1
         Top             =   -1680
         Width           =   15375
         PropVer         =   50
         xcx             =   27120
         xcy             =   609
         PropFile        =   ""
         PropDesignTime  =   1
         DeletePropFile  =   0
         IntVal          =   55
         xBfStyle1       =   63838276
         xBfStyle2       =   1951095935
         xBfStyle3       =   1904034875
         xBfStyle4       =   -1635599419
         TabCount        =   16
         CurrentTab      =   12
         FlatProperties  =   0   'False
         BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hide Search Panel"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(1) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Shop"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(2) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Avail"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(3) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Create PNR"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(4) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "TAU"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(5) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Timatic"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(6) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Recap"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(7) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Seat"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(8) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "SI"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(9) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Quote && File"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(10) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "PreTrip"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(11) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Fare Diff"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(12) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "EItin"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(13) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Queue"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(14) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Issue Doc"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(15) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Rmk"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
         EndProperty
         BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            ToolTipCloseButton=   "Close"
            ToolTipLeftButton=   "Scroll Left/Up"
            ToolTipRightButton=   "Scroll Right/Down"
            ToolTipRestoreButton=   "Restore"
            ToolTipMinimizeButton=   "Minimize"
         EndProperty
         Appearance      =   1
         ClientArea      =   1
         Enabled         =   0
         FlatProperties  =   0
         MousePointer    =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         Style           =   21
         UseClientAreaColors=   0
         BackColor       =   -2147483628
         BorderColor     =   6973442
         BrightHighlightColor=   -2147483628
         ForeColor       =   0
         HighlightColor  =   6973442
         ShadowColor     =   -2147483632
         ScrollingButtonBackColor=   -2147483633
         ScrollingButtonBorderColor=   -2147483627
         ScrollingButtonForeColor=   -2147483630
         ScrollingButtonForeColorGrayed=   -2147483630
         ScrollingButtonHighlightColor=   -2147483628
         ScrollingButtonShadowColor=   -2147483632
         TabsBoldActive  =   1
         TabsDropText    =   0
         TabsEachRow     =   0
         TabsFillComplete=   0
         TabsFixed       =   0
         TabsFlyby       =   1
         TabsRows        =   1
         TabsRowIndent   =   -1
         TabsTextOnly    =   0
         TabsLeftMargin  =   0
         TabsRightMargin =   0
         ScrollButtonStyle=   5
         ScrollCondScrollButtons=   0
         ScrollFullSize  =   1
         ScrollHideScrollButtons=   0
         ScrollNoTruncate=   0
         ScrollScrollable=   0
         ScrollScrollOnLeft=   0
         AlwaysShowAccel =   0
         UseExactRegion  =   1
         UseThemes       =   -1  'True
         ShowFocusRectangle=   1
         ButtonAlignment =   0
         CloseButton     =   0
         CloseButtonDisabled=   0
         CloseButtonWMCLOSE=   1
         CloseButtonFullSize=   0
         CloseButtonAlignment=   0
         MinimizeButton  =   0
         RestoreButton   =   0
         CustomCode      =   0
         xDesign         =   15
         yDesign         =   345
         List(0)Count    =   0
         List(1)Count    =   0
         List(2)Count    =   0
         List(3)Count    =   0
         List(4)Count    =   0
         List(5)Count    =   0
         List(6)Count    =   0
         List(7)Count    =   0
         List(8)Count    =   0
         List(9)Count    =   0
         List(10)Count   =   0
         List(11)Count   =   0
         List(12)Count   =   0
         List(13)Count   =   0
         List(14)Count   =   0
         List(15)Count   =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin SftTabsLib.SftTabs SftSubTabs 
         Height          =   330
         Index           =   1
         Left            =   -14095
         TabIndex        =   5
         Top             =   -1675
         Visible         =   0   'False
         Width           =   13095
         PropVer         =   50
         xcx             =   23098
         xcy             =   582
         PropFile        =   ""
         PropDesignTime  =   1
         DeletePropFile  =   0
         IntVal          =   55
         xBfStyle1       =   63838276
         xBfStyle2       =   1951095935
         xBfStyle3       =   1904034875
         xBfStyle4       =   -1635599419
         TabCount        =   4
         CurrentTab      =   0
         FlatProperties  =   0   'False
         BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hide Search Panel"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(1) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Book - Harp"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(2) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hotel Book"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tab(3) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hotel MI"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   6973442
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
         EndProperty
         BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            ToolTipCloseButton=   "Close"
            ToolTipLeftButton=   "Scroll Left/Up"
            ToolTipRightButton=   "Scroll Right/Down"
            ToolTipRestoreButton=   "Restore"
            ToolTipMinimizeButton=   "Minimize"
         EndProperty
         Appearance      =   1
         ClientArea      =   1
         Enabled         =   0
         FlatProperties  =   0
         MousePointer    =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         Style           =   21
         UseClientAreaColors=   0
         BackColor       =   -2147483628
         BorderColor     =   6973442
         BrightHighlightColor=   -2147483628
         ForeColor       =   0
         HighlightColor  =   6973442
         ShadowColor     =   -2147483632
         ScrollingButtonBackColor=   -2147483633
         ScrollingButtonBorderColor=   -2147483627
         ScrollingButtonForeColor=   -2147483630
         ScrollingButtonForeColorGrayed=   -2147483630
         ScrollingButtonHighlightColor=   -2147483628
         ScrollingButtonShadowColor=   -2147483632
         TabsBoldActive  =   1
         TabsDropText    =   0
         TabsEachRow     =   0
         TabsFillComplete=   0
         TabsFixed       =   0
         TabsFlyby       =   1
         TabsRows        =   1
         TabsRowIndent   =   -1
         TabsTextOnly    =   0
         TabsLeftMargin  =   0
         TabsRightMargin =   0
         ScrollButtonStyle=   5
         ScrollCondScrollButtons=   0
         ScrollFullSize  =   1
         ScrollHideScrollButtons=   0
         ScrollNoTruncate=   0
         ScrollScrollable=   0
         ScrollScrollOnLeft=   0
         AlwaysShowAccel =   0
         UseExactRegion  =   1
         UseThemes       =   -1  'True
         ShowFocusRectangle=   1
         ButtonAlignment =   0
         CloseButton     =   0
         CloseButtonDisabled=   0
         CloseButtonWMCLOSE=   1
         CloseButtonFullSize=   0
         CloseButtonAlignment=   0
         MinimizeButton  =   0
         RestoreButton   =   0
         CustomCode      =   0
         xDesign         =   15
         yDesign         =   345
         List(0)Count    =   0
         List(1)Count    =   0
         List(2)Count    =   0
         List(3)Count    =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin SftTabsLib.SftTabs SftSubTabs 
         Height          =   345
         Index           =   5
         Left            =   -16375
         TabIndex        =   6
         Top             =   -1705
         Width           =   15375
         PropVer         =   50
         xcx             =   27120
         xcy             =   609
         PropFile        =   ""
         PropDesignTime  =   1
         DeletePropFile  =   0
         IntVal          =   55
         xBfStyle1       =   63838276
         xBfStyle2       =   1951095935
         xBfStyle3       =   1904034875
         xBfStyle4       =   -1635599419
         TabCount        =   1
         CurrentTab      =   0
         FlatProperties  =   0   'False
         BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hide Search Panel"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
         EndProperty
         BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            ToolTipCloseButton=   "Close"
            ToolTipLeftButton=   "Scroll Left/Up"
            ToolTipRightButton=   "Scroll Right/Down"
            ToolTipRestoreButton=   "Restore"
            ToolTipMinimizeButton=   "Minimize"
         EndProperty
         Appearance      =   1
         ClientArea      =   1
         Enabled         =   0
         FlatProperties  =   0
         MousePointer    =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         Style           =   21
         UseClientAreaColors=   0
         BackColor       =   -2147483628
         BorderColor     =   6973442
         BrightHighlightColor=   -2147483628
         ForeColor       =   0
         HighlightColor  =   6973442
         ShadowColor     =   -2147483632
         ScrollingButtonBackColor=   -2147483633
         ScrollingButtonBorderColor=   -2147483627
         ScrollingButtonForeColor=   -2147483630
         ScrollingButtonForeColorGrayed=   -2147483630
         ScrollingButtonHighlightColor=   -2147483628
         ScrollingButtonShadowColor=   -2147483632
         TabsBoldActive  =   1
         TabsDropText    =   0
         TabsEachRow     =   0
         TabsFillComplete=   0
         TabsFixed       =   0
         TabsFlyby       =   1
         TabsRows        =   1
         TabsRowIndent   =   -1
         TabsTextOnly    =   0
         TabsLeftMargin  =   0
         TabsRightMargin =   0
         ScrollButtonStyle=   5
         ScrollCondScrollButtons=   0
         ScrollFullSize  =   1
         ScrollHideScrollButtons=   0
         ScrollNoTruncate=   0
         ScrollScrollable=   0
         ScrollScrollOnLeft=   0
         AlwaysShowAccel =   0
         UseExactRegion  =   1
         UseThemes       =   -1  'True
         ShowFocusRectangle=   1
         ButtonAlignment =   0
         CloseButton     =   0
         CloseButtonDisabled=   0
         CloseButtonWMCLOSE=   1
         CloseButtonFullSize=   0
         CloseButtonAlignment=   0
         MinimizeButton  =   0
         RestoreButton   =   0
         CustomCode      =   0
         xDesign         =   15
         yDesign         =   345
         List(0)Count    =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin SftTabsLib.SftTabs SftSubTabs 
         Height          =   345
         Index           =   6
         Left            =   -16375
         TabIndex        =   9
         Top             =   -1705
         Width           =   15375
         PropVer         =   50
         xcx             =   27120
         xcy             =   609
         PropFile        =   ""
         PropDesignTime  =   1
         DeletePropFile  =   0
         IntVal          =   55
         xBfStyle1       =   63838276
         xBfStyle2       =   1951095935
         xBfStyle3       =   1904034875
         xBfStyle4       =   -1635599419
         TabCount        =   1
         CurrentTab      =   0
         FlatProperties  =   0   'False
         BeginProperty Tab(0) {48328725-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            Text            =   "Hide Search Panel"
            ToolTip         =   ""
            Object.Align           =   0
            BackColor       =   -1
            BackColorActive =   -1
            ClientAreaColor =   -1
            Enabled         =   1
            FlyByColor      =   -1
            ForeColor       =   -1
            ForeColorActive =   -1
            Name            =   ""
            Hidden          =   0
            BackColorStart  =   -1
            BackColorEnd    =   -1
            BackColorActiveStart=   -1
            BackColorActiveEnd=   -1
            ClientAreaColorStart=   -1
            ClientAreaColorEnd=   -1
         EndProperty
         BeginProperty Tabs {48328721-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
         EndProperty
         BeginProperty Scrolling {48328724-0993-461C-B983-0EAAA4A43E5C} 
            PropVer         =   0
            ToolTipCloseButton=   "Close"
            ToolTipLeftButton=   "Scroll Left/Up"
            ToolTipRightButton=   "Scroll Right/Down"
            ToolTipRestoreButton=   "Restore"
            ToolTipMinimizeButton=   "Minimize"
         EndProperty
         Appearance      =   1
         ClientArea      =   1
         Enabled         =   0
         FlatProperties  =   0
         MousePointer    =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         Style           =   21
         UseClientAreaColors=   0
         BackColor       =   -2147483628
         BorderColor     =   6973442
         BrightHighlightColor=   -2147483628
         ForeColor       =   0
         HighlightColor  =   6973442
         ShadowColor     =   -2147483632
         ScrollingButtonBackColor=   -2147483633
         ScrollingButtonBorderColor=   -2147483627
         ScrollingButtonForeColor=   -2147483630
         ScrollingButtonForeColorGrayed=   -2147483630
         ScrollingButtonHighlightColor=   -2147483628
         ScrollingButtonShadowColor=   -2147483632
         TabsBoldActive  =   1
         TabsDropText    =   0
         TabsEachRow     =   0
         TabsFillComplete=   0
         TabsFixed       =   0
         TabsFlyby       =   1
         TabsRows        =   1
         TabsRowIndent   =   -1
         TabsTextOnly    =   0
         TabsLeftMargin  =   0
         TabsRightMargin =   0
         ScrollButtonStyle=   5
         ScrollCondScrollButtons=   0
         ScrollFullSize  =   1
         ScrollHideScrollButtons=   0
         ScrollNoTruncate=   0
         ScrollScrollable=   0
         ScrollScrollOnLeft=   0
         AlwaysShowAccel =   0
         UseExactRegion  =   1
         UseThemes       =   -1  'True
         ShowFocusRectangle=   1
         ButtonAlignment =   0
         CloseButton     =   0
         CloseButtonDisabled=   0
         CloseButtonWMCLOSE=   1
         CloseButtonFullSize=   0
         CloseButtonAlignment=   0
         MinimizeButton  =   0
         RestoreButton   =   0
         CustomCode      =   0
         xDesign         =   15
         yDesign         =   345
         List(0)Count    =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin VB.ComboBox cmbDatabase 
      Height          =   315
      Left            =   12000
      Style           =   2  'Dropdown List
      TabIndex        =   8
      Top             =   50
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.Timer timer1 
      Interval        =   100
      Left            =   6840
      Top             =   0
   End
   Begin VB.Timer timerUnload 
      Enabled         =   0   'False
      Interval        =   100
      Left            =   7320
      Top             =   0
   End
   Begin VB.Label lblDatabase 
      BackStyle       =   0  'Transparent
      Caption         =   "Database Connected : "
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   10005
      TabIndex        =   7
      Top             =   75
      Visible         =   0   'False
      Width           =   1935
   End
End
Attribute VB_Name = "frmBars"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim strPath As String
Dim dx8 As New DirectX8
Dim diDevice As DirectInputDevice8
Dim diState As DIKEYBOARDSTATE
Dim dinput As DirectInput8
Dim WithEvents objVPlistener As VIEWPOINTLISTENERLib.ListenerObj
Attribute objVPlistener.VB_VarHelpID = -1

Private Sub Form_Load()
    strPath = App.Path & IIf(Right(App.Path, 1) = "\", "", "\")
    'JY - 20100604 - Set width based on FP width
    frmBars.Width = gFPWidth
    SftTabs.Width = gFPWidth
    
    'CC - V1.2.7 20111011 - CR114 - Enable Hotel MI for HBU
    SftSubTabs(1).Visible = False
    'SftSubTabs(1).Tab(0).Visible = False
    'SftSubTabs(1).Tab(1).Visible = False
    'SftSubTabs(1).Tab(2).Visible = True
    'SftSubTabs(1).Tab(3).Visible = True
    
    'create an interface to the keyboard
    Set dinput = dx8.DirectInputCreate()
    Set diDevice = dinput.CreateDevice("GUID_SysKeyboard")
    diDevice.SetCommonDataFormat DIFORMAT_KEYBOARD
    diDevice.SetCooperativeLevel Me.hwnd, DISCL_BACKGROUND Or DISCL_NONEXCLUSIVE
    diDevice.Acquire
    SftTabs.Tabs.Current = 0
    
    ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
    If gIntModuleType = gModuleType.SYEX Then
        SftSubTabs(1).Tabs.Current = -1
        CustomizeTabSyEx
    Else
        SftSubTabs(0).Tabs.Current = -1
    End If
    
   
    
    'JY - V1.2.6 20110916 - CR109 - Startup form for users to select database to be connected (AU ESC)
    If gstrDatabaseConnected <> "" Then
       lblDatabase.Visible = True
       cmbDatabase.Visible = True
       cmbDatabase.AddItem "Singapore"
       cmbDatabase.AddItem "Hong Kong"
       cmbDatabase.Left = Me.Width - cmbDatabase.Width - 100
       lblDatabase.Left = cmbDatabase.Left - lblDatabase.Width - 50
       If gstrDatabaseConnected = "SG" Then
          cmbDatabase.listindex = 0
       ElseIf gstrDatabaseConnected = "HK" Then
          cmbDatabase.listindex = 1
       End If
    End If

    
End Sub

Private Sub SftSubTabs_MouseMove(Index As Integer, ByVal Button As Integer, ByVal Shift As Integer, ByVal xPos As Single, ByVal yPos As Single)
    Dim i As Integer
    Dim sngTop As Single
    Dim sngLeft As Single
    Dim sngWidth As Single
    Dim sngHeight As Single
    
    'CC - V1.2.7 20111011 - CR114 - Enable Hotel MI for HBU
    If Index = 1 Then Exit Sub
    
    For i = 0 To SftSubTabs(Index).Tabs.Count - 1
        If SftSubTabs(Index).Tab(i).Visible = True Then
            SftSubTabs(Index).Tab(i).GetPosition sngLeft, sngTop, sngWidth, sngHeight
            If xPos >= sngLeft And xPos <= (sngLeft + sngWidth) And yPos >= sngTop And yPos <= sngTop + sngHeight Then
               ' Set current tab if mouse cursor is in tab's area
               If SftSubTabs(Index).Tabs.Current <> i Then
                  If SftSubTabs(Index).Tab(i).Enabled = True Then SftSubTabs(Index).Tabs.Current = i
                  Exit For
                End If
            End If
        End If
    Next
End Sub

Private Sub SftSubTabs_MouseDown(Index As Integer, ByVal Button As Integer, ByVal Shift As Integer, ByVal xPos As Single, ByVal yPos As Single)
    Dim i As Integer
    Dim sngTop As Single
    Dim sngLeft As Single
    Dim sngWidth As Single
    Dim sngHeight As Single
    Dim strMsg As String

    For i = 0 To SftSubTabs(Index).Tabs.Count - 1
        SftSubTabs(Index).Tab(i).GetPosition sngLeft, sngTop, sngWidth, sngHeight
        'If xPos >= sngLeft And xPos <= (sngLeft + sngWidth) And yPos >= sngTop And yPos <= sngTop + sngHeight Then
        
        ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
        'Add one more checking to the if statement below due to the bug in the sftTab
        If xPos >= sngLeft And xPos <= (sngLeft + sngWidth) And yPos >= sngTop And yPos <= sngTop + sngHeight And SftSubTabs(Index).Tab(i).Visible = True Then
           ' Activate module if mouse up is in tab's area
           If Index = 0 Then
                 'Button on Air Products was clicked
                 If SftSubTabs(Index).Tab(i).Enabled = False Then Exit Sub
                 
                 ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                 If gIntModuleType <> gModuleType.SYEX Then
                    If i > 0 Then
                        If frmSideBar.cmbSelectType.Text = "Profile" And frmSideBar.cmbSelectReq.Text = "New Booking - 6" Then
                            If Trim(frmSideBar.txtRequestor) = "" Then
                               strMsg = "Missing requestor name ..." & Chr(13)
                            End If
                        End If
                        If strMsg <> "" Then
                           DataisRequired strMsg
                           Exit Sub
                        End If
                     End If
                 End If

                 
                 If i = 0 Then
                   searchPanel
                 ElseIf i = 1 Then
                   lowFareShop
                 ElseIf i = 2 Then
                   
                   airAvail
                 ElseIf i = 3 Then
                   startBook
                 ElseIf i = 4 Then
                   tau
                 ElseIf i = 5 Then
                   timatic
                 ElseIf i = 6 Then
                   recap
                 ElseIf i = 7 Then
                   seat
                 ElseIf i = 8 Then
                   meal
                 ElseIf i = 9 Then
                   quoteFile
                 ElseIf i = 10 Then
                   pretrip
                 ElseIf i = 11 Then
                   fareDiff
                 ElseIf i = 12 Then
                   sendEitin
                 ElseIf i = 13 Then
                   queuePNR
                 ElseIf i = 14 Then
                   issueDocs
                 ElseIf i = 15 Then
                   Rmk
                 End If
           ElseIf Index = 1 Then
'CC - V1.2.7 20111011 - CR114 - Enable Hotel MI for HBU
'                If SftSubTabs(Index).Tab(i).Enabled = False Then Exit Sub
'                If i = 0 Then
'                    searchPanel
'                ElseIf i = 1 Then
'
'                    ShellExecute 0, "open", "http://10.200.120.65/HarpAgency/", vbNullString, vbNullString, 1
'                    If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
'                    pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
'                    gconModAir, frmSideBar.cmbSelectType.Text, gconSModBkHtl, _
'                    "HARP", gconFormLoad, gstrProcessGrpID, Now, Now
'
'                ElseIf i = 2 Then
'                    sellHotel
'                ElseIf i = 3 Then
'                    HtlMI
'                End If
           ElseIf Index = 2 Then
                 'Button on Car Products was clicked
                 If SftSubTabs(Index).Tab(i).Enabled = False Then Exit Sub
                 If i > 0 Then
                ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                'do not check input from frmSideBar for SyEx module
                    If gIntModuleType <> gModuleType.SYEX Then
                        If frmSideBar.cmbSelectType.Text = "Profile" And frmSideBar.cmbSelectReq.Text = "New Booking - 6" Then
                           If Trim(frmSideBar.txtRequestor) = "" Then
                              strMsg = "Missing requestor name ..." & Chr(13)
                           End If
                        End If
                        If strMsg <> "" Then
                           DataisRequired strMsg
                           Exit Sub
                        End If
                    End If
                 End If

                 
                 If i = 0 Then
                    searchPanel
                 ElseIf i = 1 Then
                    sellCar
                 ElseIf i = 2 Then
                    carMI
                 End If
           ElseIf Index = 3 Then
                 'Button on Other Services Products was clicked
                 If SftSubTabs(Index).Tab(i).Enabled = False Then Exit Sub
                 If i > 0 And i <> 4 Then
                ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                'do not check input from frmSideBar for SyEx module
                    If gIntModuleType <> gModuleType.SYEX Then
                        If frmSideBar.cmbSelectType.Text = "Profile" And frmSideBar.cmbSelectReq.Text = "New Booking - 6" Then
                            If Trim(frmSideBar.txtRequestor) = "" Then
                               strMsg = "Missing requestor name ..." & Chr(13)
                            End If
                        End If
                        If strMsg <> "" Then
                           DataisRequired strMsg
                           Exit Sub
                        End If
                    End If
                End If
                 
                 If i = 0 Then
                    searchPanel
                 ElseIf i = 1 Then
                    auxilaryPdt
                 ElseIf i = 2 Then
                    reprintEO
                 ElseIf i = 3 Then
                    DespVisaUpdate
                 ElseIf i = 4 Then
                    raiseCheque
                 End If
           ElseIf Index = 4 Then
                 'Button on Miscellaneous was clicked
                 If SftSubTabs(Index).Tab(i).Enabled = False Then Exit Sub
                 If i > 0 Then
                ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                'do not check input from frmSideBar for SyEx module
                    If gIntModuleType <> gModuleType.SYEX Then
                        If frmSideBar.cmbSelectType.Text = "Profile" And frmSideBar.cmbSelectReq.Text = "New Booking - 6" Then
                            If Trim(frmSideBar.txtRequestor) = "" Then
                               strMsg = "Missing requestor name ..." & Chr(13)
                            End If
                        End If
                        If strMsg <> "" Then
                           DataisRequired strMsg
                           Exit Sub
                        End If
                    End If
                 End If
                 
                 If i = 0 Then
                    searchPanel
                 ElseIf i = 1 Then
                    openDespatchExe
                 ElseIf i = 2 Then
                    sendLTT
                 ElseIf i = 3 Then
                    ShellExecute 0, "open", "C:\fp\swdir\CustomViewpoint\LocalScripts\MCO\MCOWeb.html", vbNullString, vbNullString, 1
                    If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
                    pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
                    gconModMisc, frmSideBar.cmbSelectType.Text, gconSModMCO, _
                    Me.Name, gconFormLoad, gstrProcessGrpID, Now, Now

                 ElseIf i = 4 Then
                    Shell "C:\fp\ETR\ETR.exe"
                    If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
                    pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
                    gconModMisc, frmSideBar.cmbSelectType.Text, gconSModETR, _
                    Me.Name, gconFormLoad, gstrProcessGrpID, Now, Now
                 
                 ElseIf i = 5 Then
                    ShellExecute 0, "open", "C:\fp\swdir\CustomViewpoint\WBSNumberValidator\ifwbs.js", vbNullString, vbNullString, 1
                    If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
                    pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
                    gconModMisc, frmSideBar.cmbSelectType.Text, gconSModMCO, _
                    Me.Name, gconFormLoad, gstrProcessGrpID, Now, Now
                    
                 End If
              'Preethi - 20110704  - Tracking of Touches to CWT Booking
            ElseIf Index = 5 Then
            
                 If i > 0 Then
                ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                'do not check input from frmSideBar for SyEx module
                    If gIntModuleType <> gModuleType.SYEX Then
                        If frmSideBar.cmbSelectType.Text = "Profile" And frmSideBar.cmbSelectReq.Text = "New Booking - 6" Then
                            If Trim(frmSideBar.txtRequestor) = "" Then
                               strMsg = "Missing requestor name ..." & Chr(13)
                            End If
                        End If
                        If strMsg <> "" Then
                           DataisRequired strMsg
                           Exit Sub
                        End If
                    End If
                 End If
                If i = 0 Then
                    searchPanel
                End If
            'Preethi - V1.2.8  20111031 - CR101 - Aqua Itin Remark Screen
           ElseIf Index = 6 Then
                If i > 0 Then
                ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                'do not check input from frmSideBar for SyEx module
                    If gIntModuleType <> gModuleType.SYEX Then
                        If frmSideBar.cmbSelectType.Text = "Profile" And frmSideBar.cmbSelectReq.Text = "New Booking - 6" Then
                            If Trim(frmSideBar.txtRequestor) = "" Then
                               strMsg = "Missing requestor name ..." & Chr(13)
                            End If
                        End If
                        If strMsg <> "" Then
                           DataisRequired strMsg
                           Exit Sub
                        End If
                    End If
                 End If
                If i = 0 Then
                    searchPanel
                End If
           End If
           Exit For
        End If
    Next
End Sub

'CC - V1.2.7 20111011 - CR114 - Enable Hotel MI for HBU
Private Sub SftSubTabs_MouseUp(Index As Integer, ByVal Button As Integer, ByVal Shift As Integer, ByVal xPos As Single, ByVal yPos As Single)
    Dim intTabNum As Integer
    
    Select Case Index
        Case 1  'Hotel
            intTabNum = SftSubTabs(Index).Tabs.Current
            'gbolHBUUser = ApplicationUser(gobjHost.AgentPCC, gobjHost.AgentSine, "HBU")
            
            If gbolHBUUser Then
                preFormLoad
                displayPNRinBar
                If intTabNum = 2 Then
                    

                      ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                      If gIntModuleType = gModuleType.SYEX Then
                            'Auto create retention line for SyEx flow
                            ' ZhiSam - V1.3.1 - 20120917 - CR134 - SyEx Version : Create Rentention Line for Hotel Booking
                            'Create Retention Line
                               'Check if Pofile PCC and Profile Name is missing
                            If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
                               If gobjPNR.RecLoc = "" Then
                                 CreateRetentionLine
                                 gobjPNR.loadPNR
                               End If
                               
                               If gobjPNR.RecLoc <> "" Then
                                 gbolExitHBT = False
                                 callHBT
                               Else
                                 modMsgBox.OKMsg = "OK"
                                 modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
                               End If
                            Else
                               'Skip the Hotel Booking Process if BAR is not found
                               modMsgBox.OKMsg = "OK"
                               modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR.", vbOKOnly + vbDefaultButton1, "Error"
                            End If
        
                      Else
                            ' For Point & Click Flow
                            If gobjPNR.RecLoc = "" Then
                               modMsgBox.OKMsg = "OK"
                               modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
                            Else
                               'Check if Pofile PCC and Profile Name is missing
                               If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
                                  gbolExitHBT = False
                                  callHBT
                               Else
                                  'Skip the Hotel Booking Process if BAR is not found
                                  modMsgBox.OKMsg = "OK"
                                  modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR.", vbOKOnly + vbDefaultButton1, "Error"
                               End If
                            End If
                            
                      End If
                    
                    
                    
                    
                    
                    
                ElseIf intTabNum = 3 Then
                    HtlMI
                End If
            Else
                'If SftSubTabs(Index).Tab(intTabNum).Enabled = False Then Exit Sub
                If intTabNum = 0 Then
                    searchPanel
                ElseIf intTabNum = 1 Then
                    
                    ShellExecute 0, "open", "http://10.200.120.65/HarpAgency/", vbNullString, vbNullString, 1
                    If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
                    pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
                    gconModAir, frmSideBar.cmbSelectType.Text, gconSModBkHtl, _
                    "HARP", gconFormLoad, gstrProcessGrpID, Now, Now

                ElseIf intTabNum = 2 Then
                    sellHotel
                ElseIf intTabNum = 3 Then
                    HtlMI
                End If
                
            End If
            
        Case Else
    
    End Select

End Sub

'CC - V1.2.7 20111011 - CR114 - Enable Hotel MI for HBU
Private Sub SftSubTabs_Switched(Index As Integer)
'    Dim bolHBUUser As Boolean
'    Dim intTabNum As Integer
'
'    Select Case Index
'        Case 1  'Hotel
'            intTabNum = SftSubTabs(Index).Tabs.Current
'            bolHBUUser = ApplicationUser(gobjHost.AgentPCC, gobjHost.AgentSine, "HBU")
'
'            If bolHBUUser Then
'                If intTabNum = 2 Then
'
'
'                            If gobjPNR.RecLoc = "" Then
'                               modMsgBox.OKMsg = "OK"
'                               modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
'                            Else
'                               'Check if Pofile PCC and Profile Name is missing
'                               If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
'                                  gbolExitHBT = False
'                                  callHBT
'                               Else
'                                  'Skip the Hotel Booking Process if BAR is not found
'                                  modMsgBox.OKMsg = "OK"
'                                  modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR.", vbOKOnly + vbDefaultButton1, "Error"
'                               End If
'                            End If
'
'
'
'
'
'                ElseIf intTabNum = 3 Then
'                    HtlMI
'                End If
'            Else
'                'If SftSubTabs(Index).Tab(intTabNum).Enabled = False Then Exit Sub
'                If intTabNum = 0 Then
'                    searchPanel
'                ElseIf intTabNum = 1 Then
'
'                    ShellExecute 0, "open", "http://10.200.120.65/HarpAgency/", vbNullString, vbNullString, 1
'                    If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
'                    pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
'                    gconModAir, frmSideBar.cmbSelectType.Text, gconSModBkHtl, _
'                    "HARP", gconFormLoad, gstrProcessGrpID, Now, Now
'
'                ElseIf intTabNum = 2 Then
'                    sellHotel
'                ElseIf intTabNum = 3 Then
'                    HtlMI
'                End If
'
'            End If
'
'        Case Else
'
'    End Select
End Sub

Private Sub SftSubTabs_Switching(Index As Integer, NextTab As Integer, Allow As Boolean, Refresh As Boolean)
    Dim PicObject As StdPicture
    
    'Reset all pictures in each tab to be inactive mode
    If Index = 0 Then
        Set PicObject = LoadPicture(strPath & "Icons\Search_Off.bmp")
        Set SftSubTabs(Index).Tab(0).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\Shop_Off.bmp")
        Set SftSubTabs(Index).Tab(1).Picture = PicObject
        
        Set PicObject = LoadPicture(strPath & "Icons\AirAvail_Off.bmp")
        Set SftSubTabs(Index).Tab(2).Picture = PicObject
        
        Set PicObject = LoadPicture(strPath & "Icons\Book_Off.bmp")
        Set SftSubTabs(Index).Tab(3).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\TAU_Off.bmp")
        Set SftSubTabs(Index).Tab(4).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\Timatic_Off.bmp")
        Set SftSubTabs(Index).Tab(5).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\Recap_Off.bmp")
        Set SftSubTabs(Index).Tab(6).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\Seat_Off.bmp")
        Set SftSubTabs(Index).Tab(7).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\Meal_Off.bmp")
        Set SftSubTabs(Index).Tab(8).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\File_Off.bmp")
        Set SftSubTabs(Index).Tab(9).Picture = PicObject
        
        Set PicObject = LoadPicture(strPath & "Icons\SendItin_Off.bmp")
        Set SftSubTabs(Index).Tab(10).Picture = PicObject
        
        Set PicObject = LoadPicture(strPath & "Icons\SendItin_Off.bmp")
        Set SftSubTabs(Index).Tab(12).Picture = PicObject
        Set PicObject = LoadPicture(strPath & "Icons\IssueDocs_Off.bmp")
        Set SftSubTabs(Index).Tab(14).Picture = PicObject
        
        ' Change tab picture on active/inactive
        If NextTab = 0 Then
           Set PicObject = LoadPicture(strPath & "Icons\Search_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 1 Then
           Set PicObject = LoadPicture(strPath & "Icons\Shop_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 2 Then
           Set PicObject = LoadPicture(strPath & "Icons\AirAvail_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 3 Then
           Set PicObject = LoadPicture(strPath & "Icons\Book_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 4 Then
           Set PicObject = LoadPicture(strPath & "Icons\TAU_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 5 Then
           Set PicObject = LoadPicture(strPath & "Icons\Timatic_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 6 Then
           Set PicObject = LoadPicture(strPath & "Icons\Recap_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 7 Then
           Set PicObject = LoadPicture(strPath & "Icons\Seat_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 8 Then
           Set PicObject = LoadPicture(strPath & "Icons\Meal_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 9 Then
           Set PicObject = LoadPicture(strPath & "Icons\File_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        
        ElseIf NextTab = 10 Then
           Set PicObject = LoadPicture(strPath & "Icons\SendItin_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        
        ElseIf NextTab = 12 Then
           Set PicObject = LoadPicture(strPath & "Icons\SendItin_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        ElseIf NextTab = 14 Then
           Set PicObject = LoadPicture(strPath & "Icons\IssueDocs_On.bmp")
           Set SftSubTabs(Index).Tab(NextTab).Picture = PicObject
        End If
    End If
End Sub

'CC - 20110816 - HBU
Private Sub SftTabs_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal xPos As Single, ByVal yPos As Single)
    Dim i As Integer
    Dim sngTop As Single
    Dim sngLeft As Single
    Dim sngWidth As Single
    Dim sngHeight As Single
    
    Dim strModule As String
    
    For i = 0 To SftTabs.Tabs.Count - 1
      
        If SftTabs.Tab(i).Visible = True Then
            SftTabs.Tab(i).GetPosition sngLeft, sngTop, sngWidth, sngHeight
            If xPos >= sngLeft And xPos <= (sngLeft + sngWidth) And yPos >= sngTop And yPos <= sngTop + sngHeight Then
               ' Set current tab if mouse cursor is in tab's area
               If SftTabs.Tabs.Current <> i Then SftTabs.Tabs.Current = i
               If i = 0 Then SftSubTabs(i).Tabs.Current = -1
               If i = 1 Then
                      'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
                      'Hotel Tab is clicked

                       If checkSignOn = True Then
                          preFormLoad
                          displayPNRinBar
                          
                          strModule = ""
                          gbolHBUUser = ApplicationUser(gobjHost.AgentPCC, gobjHost.AgentSine, "HBU", strModule)
                          'CC - V1.2.7 20111011 - CR114 - Enable Hotel MI for HBU
                          If gbolHBUUser Then
                            If strModule = "MI" Then
                                SftSubTabs(1).Visible = True
                                SftSubTabs(1).Tab(0).Visible = False
                                SftSubTabs(1).Tab(1).Visible = False
                                SftSubTabs(1).Tab(2).Visible = True
                                SftSubTabs(1).Tab(3).Visible = True
                                
                                SftSubTabs(1).Tab(2).Text = "Book - HBU"
                                'SftSubTabs(1).Visible = False
                            Else
                                    SftSubTabs(1).Visible = False
                                    ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
                                    If gIntModuleType = gModuleType.SYEX Then
                                        'if it is SyEx Flow
                                        ' ZhiSam - V1.3.1 - 20120917 - CR134 - SyEx Version : Create Rentention Line for Hotel Booking
                                        'Check if Pofile PCC and Profile Name is missing
                                        If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
                                           'gbolExitHBT = False
                                           'callHBT
                                           SftSubTabs(1).Visible = True
                                        Else
                                           'Skip the Hotel Booking Process if BAR is not found
                                           modMsgBox.OKMsg = "OK"
                                           modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR.", vbOKOnly + vbDefaultButton1, "Error"
                                        End If
                                
                                    Else
                                        'Point and Click window and SP full module
                                        If gobjPNR.RecLoc = "" Then
                                             modMsgBox.OKMsg = "OK"
                                             modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
                                        Else
                                            'Check if Pofile PCC and Profile Name is missing
                                            If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
                                                gbolExitHBT = False
                                                callHBT
                                            Else
                                            'Skip the Hotel Booking Process if BAR is not found
                                                modMsgBox.OKMsg = "OK"
                                                modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR.", vbOKOnly + vbDefaultButton1, "Error"
                                            End If
                                        End If
                                    End If
    
     
                                
                            End If
                          Else
                             SftSubTabs(1).Visible = True
                             SftSubTabs(1).Tab(0).Visible = True
                             SftSubTabs(1).Tab(1).Visible = True
                             SftSubTabs(1).Tab(2).Visible = True
                             SftSubTabs(1).Tab(3).Visible = True
                             
                             SftSubTabs(1).Tab(2).Text = "Hotel Book"
                             'SftSubTabs(1).Visible = True
                          End If
'                          If bolHBUUser Then
'                            If gobjPNR.RecLoc = "" Then
'                               modMsgBox.OKMsg = "OK"
'                               modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
'                            Else
'                               'Check if Pofile PCC and Profile Name is missing
'                               If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
'                                  gbolExitHBT = False
'                                  callHBT
'                               Else
'                                  'Skip the Hotel Booking Process if BAR is not found
'                                  modMsgBox.OKMsg = "OK"
'                                  modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR.", vbOKOnly + vbDefaultButton1, "Error"
'                               End If
'                            End If
'                          End If
                      End If
               End If
               'Preethi -  20110704  -  Tracking of Touches to CWT Booking
       
           If i = 5 Then
              Set gobjPNR = New CWT_GalileoPNR3.PNR
              gobjPNR.loadPNR
              TrackingTouches
           End If
        
        'Preethi - V1.2.8  20111031 - CR101 - Aqua Itin Remark Screen
       
            If i = 6 Then
               Set gobjPNR = New CWT_GalileoPNR3.PNR
               gobjPNR.loadPNR
               AquaItinRmk
            End If
               Exit For
            End If
        End If
    Next
End Sub


'Private Sub SftTabs_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal xPos As Single, ByVal yPos As Single)
'    Dim i As Integer
'    Dim sngTop As Single
'    Dim sngLeft As Single
'    Dim sngWidth As Single
'    Dim sngHeight As Single
'    For i = 0 To SftTabs.Tabs.Count - 1
'        'Preethi -  20110704  -  Tracking of Touches to CWT Booking
'        If i = 5 Then
'            Set gobjPNR = New CWT_GalileoPNR3.PNR
'            gobjPNR.loadPNR
'            TrackingTouches
'        End If
'        If SftTabs.Tab(i).Visible = True Then
'            SftTabs.Tab(i).GetPosition sngLeft, sngTop, sngWidth, sngHeight
'            If xPos >= sngLeft And xPos <= (sngLeft + sngWidth) And yPos >= sngTop And yPos <= sngTop + sngHeight Then
'               ' Set current tab if mouse cursor is in tab's area
'               If SftTabs.Tabs.Current <> i Then SftTabs.Tabs.Current = i
'               If i = 0 Then SftSubTabs(i).Tabs.Current = -1
'               If i = 1 Then
'                      'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'                      'Hotel Tab is clicked
'                       If checkSignOn = True Then
'                          preFormLoad
'                          displayPNRinBar
'                          If gobjPNR.RecLoc = "" Then
'                             modMsgBox.OKMsg = "OK"
'                             modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
'                          Else
'                             'Check if Pofile PCC and Profile Name is missing
'                             If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
'                                gbolExitHBT = False
'                                callHBT
'                             Else
'                                'Skip the Hotel Booking Process if BAR is not found
'                                modMsgBox.OKMsg = "OK"
'                                modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR.", vbOKOnly + vbDefaultButton1, "Error"
'                             End If
'                          End If
'                      End If
'               End If
'               Exit For
'            End If
'        End If
'    Next
'End Sub

Private Sub SftTabs_Switched()
   Dim strResponse As String
   
   If SftTabs.Tabs.Current <> 1 Then
        If checkSignOn = True Then
           If gobjPNR Is Nothing = False Then
               strResponse = gobjHost.terminalEntry("*R")
               If InStr(1, strResponse, "NO B.F. TO DISPLAY - CREATE OR RETRIEVE FIRST") = 0 Then
                  Set gobjPNR = New CWT_GalileoPNR3.PNR
                  gobjPNR.loadPNR
                  displayPNRinBar
               End If
           End If
        End If
  End If
End Sub

Private Sub SftTabs_Switching(NextTab As Integer, Allow As Boolean, Refresh As Boolean)
    Dim PicObject As StdPicture
    
    'Reset all pictures in each tab to be inactive mode
    Set PicObject = LoadPicture(strPath & "Icons\Airplane_Off.bmp")
    Set SftTabs.Tab(0).Picture = PicObject
    Set PicObject = LoadPicture(strPath & "Icons\Hotel_Off.bmp")
    Set SftTabs.Tab(1).Picture = PicObject
    Set PicObject = LoadPicture(strPath & "Icons\Car_Off.bmp")
    Set SftTabs.Tab(2).Picture = PicObject
    Set PicObject = LoadPicture(strPath & "Icons\Others_Off.bmp")
    Set SftTabs.Tab(3).Picture = PicObject
    Set PicObject = LoadPicture(strPath & "Icons\AddOn_Off.bmp")
    Set SftTabs.Tab(4).Picture = PicObject
    ' Change tab picture on active/inactive
    If NextTab = 0 Then
       Set PicObject = LoadPicture(strPath & "Icons\Airplane_On.bmp")
       Set SftTabs.Tab(NextTab).Picture = PicObject
    ElseIf NextTab = 1 Then
       Set PicObject = LoadPicture(strPath & "Icons\Hotel_On.bmp")
       Set SftTabs.Tab(NextTab).Picture = PicObject
    ElseIf NextTab = 2 Then
       Set PicObject = LoadPicture(strPath & "Icons\Car_On.bmp")
       Set SftTabs.Tab(NextTab).Picture = PicObject
    ElseIf NextTab = 3 Then
       Set PicObject = LoadPicture(strPath & "Icons\Others_On.bmp")
       Set SftTabs.Tab(NextTab).Picture = PicObject
    ElseIf NextTab = 4 Then
       Set PicObject = LoadPicture(strPath & "Icons\AddOn_On.bmp")
       Set SftTabs.Tab(NextTab).Picture = PicObject
    End If
    
End Sub

Private Sub timer1_Timer()

    Dim lCurHwnd As Long
    Dim buf As String * 256
    Dim title As String
    Dim length As Long
    Dim loadedForm As Form

    '***This function has disabled due to not working in Citrix****
    
    'Get the current active window
    'lCurHwnd = GetForegroundWindow
    'length = GetWindowText(lCurHwnd, buf, Len(buf))
    'title = Left$(buf, length)
    'If InStr(1, UCase(title), UCase("Galileo Desktop")) > 0 And InStr(1, UCase(title), UCase("Galileo Desktop - [Booking File")) = 0 Then
    '    'Detect shortcuts for CWT Agent Desktop if the active window is FocalPoint Mode of Galileo Desktop
    '    CWTShortcutKeys
    'ElseIf InStr(1, UCase(title), UCase("CWT Desktop")) > 0 Then
    '   'Detect shortcuts for Galileo Desktop & CWT Agent Desktop
    '    VPShortcutKeys
    '    CWTShortcutKeys
    'End If
    
    '***************************************************************
    
    
    'Get the window text of Galileo Desktop
    length = GetWindowText(glngTargetHwnd, buf, Len(buf))
    title = Left$(buf, length)
    If InStr(1, UCase(title), UCase("Galileo Desktop - [")) > 0 Then
       'Hide all loaded forms if is in viewpoint mode
        If gMode <> "V" Then
            For Each loadedForm In Forms
                If loadedForm.Visible = True And UCase(loadedForm.Name) <> UCase("frmDDEOwner") Then
                   loadedForm.Visible = False
                   Set loadedForm = Nothing
                End If
            Next
            gMode = "V"
        End If
    Else
        'Show all loaded forms if is in focalpoint mode
        If gMode <> "F" Then
            For Each loadedForm In Forms
                If loadedForm.Visible = False And UCase(loadedForm.Name) <> UCase("frmDDEOwner") Then
                   loadedForm.Visible = True
                   loadedForm.WindowState = 0
                   Set loadedForm = Nothing
                End If
            Next
            gMode = "F"
        End If
        If frmSideBar.Visible = False Then frmSideBar.Visible = True
        
             ' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
             If gIntModuleType <> gModuleType.PC Then
                'Do not show frmCustomVP - do not need in Smart Point
             Else
                 'JY - 20100628 - Need to show back frmCustomVP
                 If frmCustomVP.Visible = False Then frmCustomVP.Visible = True
             End If
        
       
    End If
    If IsInControl(frmBars.SftSubTabs(0).Window) = False Then
       If SftSubTabs(0).Tabs.Current <> -1 Then SftSubTabs(0).Tabs.Current = -1
    End If
End Sub

Private Sub startBook()
    Dim bolMoveTraveller As Boolean
    Dim strTemp As String
    Dim strQueue As String
    Dim SysStart As Date
    Dim bolFoundCN As Boolean
    Dim bolFoundDIV As Boolean
    Dim bolfoundCD As Boolean
    Dim oldParent As Long
    
    'JY - V1.2.9 20120104 - CR117 - EM Prompt for Restricted Countries and Airlines
    Dim strMsg As String
    Dim intAns As Integer
        
    gbolCancelMove = False
    gbolGetProfileFromDB = True
    
    gbolBack = False
    gbolBackToRecap = False
    gbolBackToSI = False
    
    'Logging
    'If gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
    gbolCreatPNR = True
    
    If checkSignOn = False Then
       GoTo EndSub
    End If
    
    If Trim(frmSideBar.cmbBar.Text) = "" Then
        DataisRequired "Must select a company profile ..."
        GoTo EndSub
    End If
    
    gbolMoveProfile = True
    gbolCancelProcess = False
    
    'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
    gbolStartHBT = False
        
    'TAU->Timatic->Recap->Seat->SI->Eitin
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc <> "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR exists in GDS...", vbOKOnly + vbDefaultButton1, "CWT Desktop - PNR Exists"
        GoTo EndSub
    End If
       
'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step1:
StepPassenger:
    'JY - V1.2.9 20120104 - CR117 - EM Prompt for Restricted Countries and Airlines
    'Need to reset back the value if previous module button is clicked in subsequent module
    gbolStartHBT = False
    Load frmPassenger
    frmPassenger.Show
    Do
         DoEvents
    Loop Until isLoaded("frmPassenger") = False
    If gbolCancelProcess = True Then GoTo EndSub

'JY - V1.2.9 20120104 - CR117 - EM Prompt for Restricted Countries and Airlines
StepAQUAItinRmk:
    If gobjPNR.CompInfo.AquaItin = True Then
            
      strMsg = checkRestrictedRules
      If strMsg <> "" Then
    
         modMsgBox.YESMsg = "Yes"
         modMsgBox.NOMsg = "No"
         intAns = modMsgBox.sMsgBox(gVPMDIHwnd, strMsg, vbExclamation + vbApplicationModal + vbYesNo, "CWT Desktop")
         If intAns = vbYes Then
            Load frmAquaItinRmk
            frmAquaItinRmk.Show
            Do
              DoEvents
            Loop Until isLoaded("frmAquaItinRmk") = False
            gbolCancelProcess = False
            If gbolBack = True Then
               gbolBack = False
               GoTo StepPassenger
            End If
         End If
      End If
               
    End If

'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Invoke the Hotel Booking Tool if user selected to book hotel
StepHBT:
    If gbolStartHBT = True Then
       preFormLoad
       
       'Check if Pofile PCC and Profile Name is missing
       If gobjPNR.CompInfo.ProfileName <> "" And gobjPNR.CompInfo.ProfilePCC <> "" Then
          gbolExitHBT = False
          'Switch to Hotel Tab to display Hotel Policy
          frmBars.SftTabs.Tabs.Current = 1
          displayPNRinBar
          callHBT
          Do
            DoEvents
          Loop Until gbolExitHBT = True
       Else
          'Skip the Hotel Booking Process if BAR is not found
          modMsgBox.OKMsg = "OK"
          modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found in PNR." & Chr(13) & "Desktop will proceed without invoking HBT.", vbOKOnly + vbDefaultButton1, "Error"
       End If
              
    End If

'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step2:
StepVisaHealth:
    preFormLoad
    Load frmVisaHealth
    frmVisaHealth.Show
    Do
       DoEvents
    Loop Until isLoaded("frmVisaHealth") = False
    If gbolCancelProcess = True Then GoTo EndSub
    If gbolBack = True Then
       gbolBack = False
       'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
       'Change to Module Name because it is easier to maintain
       'GoTo Step1
       GoTo StepPassenger
    End If
    
'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step3:
StepRecap:
    preFormLoad
    Load frmRecap
    gbolBack = False
    frmRecap.Show
    Do
         DoEvents
    Loop Until isLoaded("frmRecap") = False
    If gbolCancelProcess = True Then GoTo EndSub
    If gbolBack = True Then
       gbolBack = False
       'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
       'Change to Module Name because it is easier to maintain
       'GoTo Step2
       GoTo StepVisaHealth
    End If
    
    If gobjPNR.AirSegCount > 0 Then

'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step4:
StepSeat:
         preFormLoad
         Load frmSeat
         frmSeat.Show
         Do
              DoEvents
         Loop Until isLoaded("frmSeat") = False
         If gbolCancelProcess = True Then GoTo EndSub
         If gbolBack = True Then
            'gbolBack = False  'Move this line to after Load frmRecap, if gbolBack = true then enable cmdFinish
            gbolBack = False
            gbolBackToRecap = True
            'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
            'Change to Module Name because it is easier to maintain
            'GoTo Step3
            GoTo StepRecap
         End If
         
'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step5:
StepSI:
         preFormLoad
         Load frmSI
         frmSI.Show
         Do
              DoEvents
         Loop Until isLoaded("frmSI") = False
         If gbolCancelProcess = True Then GoTo EndSub
            If gbolBack = True Then
               gbolBack = False
               'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
               'Change to Module Name because it is easier to maintain
               'GoTo Step4
               GoTo StepSeat
            End If
        
         End If
    
'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step6:
StepFareQuoteRequest:
         If gobjPNR.AirSegCount > 0 Then
             preFormLoad
             Load frmFareQuoteRequest
             frmFareQuoteRequest.Show
             Do
                  DoEvents
             Loop Until isLoaded("frmFareQuote") = False And isLoaded("frmFareQuoteRequest") = False
             If gbolCancelProcess = True Or gbolPerformFF = True Then GoTo EndSub
                
                If gbolBack = True Then
                    If gobjPNR.AirSegCount > 0 Then
                       gbolBack = False
                       'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
                       'Change to Module Name because it is easier to maintain
                       'GoTo Step5
                       GoTo StepSI
                    Else
                       gbolBack = False
                       gbolBackToRecap = True
                       'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
                       'Change to Module Name because it is easier to maintain
                       'GoTo Step3
                       GoTo StepRecap
                    End If
                End If
            
             'End If
         End If
         
'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step7:
StepPreTrip:

    'Check if there's any Pretrip MI, if no then do nothing
    If CheckPreTrip = True Then
        preFormLoad
        Load frmPreTrip
        frmPreTrip.Show
        Do
            DoEvents
        Loop Until isLoaded("frmPreTrip") = False
        If gbolCancelProcess = True Then GoTo EndSub
        If gbolBack = True Then
            If gobjPNR.AirSegCount > 0 Then
               gbolBack = False
               gbolBackToSI = True
               'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
               'Change to Module Name because it is easier to maintain
               'GoTo Step6
               GoTo StepFareQuoteRequest
            Else
               'gbolBack = False 'Move this line to after Load frmRecap, if gbolBack = true then enable cmdFinish
               gbolBack = False
               gbolBackToRecap = True
               'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
               'Change to Module Name because it is easier to maintain
               'GoTo Step3
               GoTo StepRecap
            End If
        End If
    End If
    
'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
'Change to Module Name because it is easier to maintain
'Step8:
StepEitin:

    preFormLoad
'    Load frmEitin
'    frmEitin.Show
'    Do
'       DoEvents
'    Loop Until isLoaded("frmEitin") = False
    
    'CC - V1.2.8 20111028  - CR110 - Aqua EItn Module
    If gobjPNR.CompInfo.AquaItin = True Then
        Load frmAquaItinRmk
        frmAquaItinRmk.Show
        Do
           DoEvents
        Loop Until isLoaded("frmAquaItinRmk") = False
        If gbolCancelProcess = True Then GoTo EndSub
        
        If gbolBack = False Then
            Load frmEItin_Aqua
            'CC - V1.2.16 20121018 - CR163 - EM trigger generation removal in QUEUE module
            frmEItin_Aqua.mstrActivateFrom = "StartBook"
            frmEItin_Aqua.Show
            Do
               DoEvents
            Loop Until isLoaded("frmEItin_Aqua") = False
            If gbolCancelProcess = True Then GoTo EndSub
            If gbolBack = True Then
                gbolBack = False
                GoTo StepEitin
            End If
        End If

    Else
        Load frmEitin
        frmEitin.Show
        Do
           DoEvents
        Loop Until isLoaded("frmEitin") = False
    End If
    
    
    If gbolCancelProcess = True Then GoTo EndSub
    If gbolBack = True Then
       If gobjPNR.AirSegCount > 0 Then
          gbolBack = False
          gbolBackToSI = True
          If CheckPreTrip = True Then
            'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
            'Change to Module Name because it is easier to maintain
            'GoTo Step7
            GoTo StepPreTrip
          Else
             'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
             'Change to Module Name because it is easier to maintain
             'GoTo Step6
             GoTo StepFareQuoteRequest
          End If
       Else
          gbolBack = False
          gbolBackToRecap = True
          If CheckPreTrip = True Then
            'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
            'Change to Module Name because it is easier to maintain
            'GoTo Step7
            GoTo StepPreTrip
          Else
            'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
            'Change to Module Name because it is easier to maintain
            'GoTo Step3
            GoTo StepRecap
          End If
       End If
    End If
    

    
    
    gbolGetProfileFromDB = False
    gbolMoveProfile = False
    
EndSub:
     gbolCreatPNR = False
     gbolBackToRecap = False
     gbolBackToSI = False
     gbolPerformFF = False
     pResetStartTime
End Sub

Private Function moveBar() As Boolean
    If gobjHost.moveProfile(gstrPCC, UCase(frmSideBar.cmbBar.Text)) <> "PRO" Then
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, "No Company Profile Found", vbOKOnly + vbDefaultButton1, "Traveller Information"
    Else
       Set gobjPNR = New CWT_GalileoPNR3.PNR
       gobjPNR.loadPNR
       moveBar = True
    End If
End Function

Private Sub searchProfileFromDB(ByVal strName As String)
    Dim rsRecord As ADODB.Recordset
    Dim strSQL As String
    
    strSQL = "Select * from tblAdHocTraveller Where Passenger like '%" & strName & "%'"
    Set rsRecord = gdbConn.Execute(strSQL)
    
    Do Until rsRecord.EOF = False

    Loop
    
    rsRecord.Close
    Set rsRecord = Nothing
    
End Sub
 
 'Preethi - 20110704  - Tracking of Touches to CWT Booking
Public Sub searchPanel()
     'Preethi - V1.2.8  20111031 - CR101 - Aqua Itin Remark Screen
    If Trim(SftSubTabs(0).Tab(0).Text) = "Hide Search Panel" Or _
       Trim(SftSubTabs(1).Tab(0).Text) = "Hide Search Panel" Or _
       Trim(SftSubTabs(2).Tab(0).Text) = "Hide Search Panel" Or _
       Trim(SftSubTabs(3).Tab(0).Text) = "Hide Search Panel" Or _
       Trim(SftSubTabs(4).Tab(0).Text) = "Hide Search Panel" Or _
       Trim(SftSubTabs(5).Tab(0).Text) = "Hide Search Panel" Or _
       Trim(SftSubTabs(6).Tab(0).Text) = "Hide Search Panel" Then
       
       'Hide Search Panel
        frmSideBar.fraSearch.Visible = False
        frmSideBar.fraInfo.Top = 80
        frmSideBar.treeViewTraveller.Top = 600

        SftSubTabs(0).Tab(0).Text = "Show Search Panel"
        SftSubTabs(1).Tab(0).Text = "Show Search Panel"
        SftSubTabs(2).Tab(0).Text = "Show Search Panel"
        SftSubTabs(3).Tab(0).Text = "Show Search Panel"
        SftSubTabs(4).Tab(0).Text = "Show Search Panel"
        SftSubTabs(5).Tab(0).Text = "Show Search Panel"
        SftSubTabs(6).Tab(0).Text = "Show Search Panel"
    ElseIf Trim(SftSubTabs(0).Tab(0).Text) = "Show Search Panel" Or _
           Trim(SftSubTabs(1).Tab(0).Text) = "Show Search Panel" Or _
           Trim(SftSubTabs(2).Tab(0).Text) = "Show Search Panel" Or _
           Trim(SftSubTabs(3).Tab(0).Text) = "Show Search Panel" Or _
           Trim(SftSubTabs(4).Tab(0).Text) = "Show Search Panel" Or _
           Trim(SftSubTabs(5).Tab(0).Text) = "Show Search Panel" Or _
           Trim(SftSubTabs(6).Tab(0).Text) = "Show Search Panel" Then
        'Show Search Panel
        frmSideBar.fraSearch.Visible = True
        frmSideBar.fraInfo.Top = 3405
        frmSideBar.treeViewTraveller.Top = 3960
        SftSubTabs(0).Tab(0).Text = "Hide Search Panel"
        SftSubTabs(1).Tab(0).Text = "Hide Search Panel"
        SftSubTabs(2).Tab(0).Text = "Hide Search Panel"
        SftSubTabs(3).Tab(0).Text = "Hide Search Panel"
        SftSubTabs(4).Tab(0).Text = "Hide Search Panel"
        SftSubTabs(5).Tab(0).Text = "Hide Search Panel"
        SftSubTabs(6).Tab(0).Text = "Hide Search Panel"
    End If
    
    'JY - 20100608 - Reset the height
    frmSideBar.fraInfo.Height = frmSideBar.Height - frmSideBar.fraInfo.Top - gPadding
    frmSideBar.treeViewTraveller.Height = frmSideBar.fraInfo.Height - (frmSideBar.treeViewTraveller.Top - frmSideBar.fraInfo.Top) - gPadding
    frmSideBar.Move 0, 0
    
End Sub

Private Sub sendEitin()
    
    'JY - V1.2.9 20120104 - CR117 - EM Prompt for Restricted Countries and Airlines
    Dim strMsg As String
    Dim intAns As Integer
    
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    preFormLoad
    
    ' ZhiSam - V1.2.18 20120311 - CR-203 - Desktop to Create Retention Line and Update TAW to TAU (SyEx with Tpro)
     If gIntModuleType <> gModuleType.PC Then
        'check if TAW line exist, update the statement to TAU
         Call functTAUupdate
   
     End If
'    Load frmEitin
'    frmEitin.Show
    'CC - V1.2.8 20111028  - CR110 - Aqua EItn Module
    If gobjPNR.CompInfo.AquaItin = True Then
        
        'JY - V1.2.9 20120104 - CR117 - EM Prompt for Restricted Countries and Airlines
        strMsg = checkRestrictedRules
        If strMsg <> "" Then
        
           modMsgBox.YESMsg = "Yes"
           modMsgBox.NOMsg = "No"
           intAns = modMsgBox.sMsgBox(gVPMDIHwnd, strMsg, vbExclamation + vbApplicationModal + vbYesNo, "CWT Desktop")
           If intAns = vbYes Then
              Load frmAquaItinRmk
              frmAquaItinRmk.Show
              Do
                DoEvents
              Loop Until isLoaded("frmAquaItinRmk") = False
           End If
        End If
        
        If PreLaunchAquaItinValidate = True Then
            Load frmEItin_Aqua
            'CC - V1.2.16 20121018 - CR163 - EM trigger generation removal in QUEUE module
            frmEItin_Aqua.mstrActivateFrom = "EItinButton"
            frmEItin_Aqua.Show
        End If
    Else
        Load frmEitin
        frmEitin.Show
    End If
End Sub

Private Sub meal()
    Dim strMsg As String
    
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    If gobjPNR.AirSegCount > 0 Then
       preFormLoad
       Load frmSI
       frmSI.Show
    Else
       strMsg = "No air segment in the PNR"
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Service Info"
    End If
End Sub
Private Sub seat()
    Dim strMsg As String
    
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    If gobjPNR.AirSegCount > 0 Then
       preFormLoad
       Load frmSeat
       frmSeat.Show
    Else
       strMsg = "No air segment in the PNR"
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Seat"
    End If
End Sub

Private Sub recap()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    preFormLoad
    Load frmRecap
    frmRecap.Show
End Sub

Private Sub VPShortcutKeys()
    diDevice.GetDeviceStateKeyboard diState
    If (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("G")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "G", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And (diState.key(getKeys("LSHIFT")) > 0 Or diState.key(getKeys("RSHIFT")) > 0) And diState.key(getKeys("R")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "R", True, True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And (diState.key(getKeys("LSHIFT")) > 0 Or diState.key(getKeys("RSHIFT")) > 0) And diState.key(getKeys("S")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "S", True, True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("B")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "B", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("P")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "P", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("O")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "O", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("K")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "K", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("R")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "R", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("G")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "G", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("W")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "W", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("S")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "S", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("U")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "U", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("Y")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "Y", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("M")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "M", , True
    ElseIf (diState.key(getKeys("LALT")) > 0 Or diState.key(getKeys("RALT")) > 0) And diState.key(getKeys("R")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "R", , , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("N")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "N", , True
    ElseIf (diState.key(getKeys("LCTRL")) > 0 Or diState.key(getKeys("RCTRL")) > 0) And diState.key(getKeys("Q")) > 0 Then
       AppActivate "Galileo Desktop"
       PressKey "Q", , True
    End If
End Sub

Private Sub CWTShortcutKeys()
    diDevice.GetDeviceStateKeyboard diState
    If diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("A")) > 0 Then
       frmBars.SetFocus
       frmBars.SftTabs.Tabs.Current = 0
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("H")) > 0 Then
       frmBars.SetFocus
       frmBars.SftTabs.Tabs.Current = 1
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("C")) > 0 Then
       frmBars.SetFocus
       frmBars.SftTabs.Tabs.Current = 2
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("O")) > 0 Then
       frmBars.SetFocus
       frmBars.SftTabs.Tabs.Current = 3
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("P")) > 0 Then
        searchPanel
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("B")) > 0 Then
        startBook
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("T")) > 0 Then
        tau
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("S")) > 0 Then
        seat
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("M")) > 0 Then
        meal
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("V")) > 0 Then
        timatic
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("R")) > 0 Then
        recap
    ElseIf diState.key(getKeys("RSHIFT")) > 0 And diState.key(getKeys("I")) > 0 Then
        sendEitin
    End If
End Sub

Private Function getKeys(key As String) As Integer
    If key = "ESC" Then
       getKeys = 1
    ElseIf key = "1" Then getKeys = 2
    ElseIf key = "2" Then getKeys = 3
    ElseIf key = "3" Then getKeys = 4
    ElseIf key = "4" Then getKeys = 5
    ElseIf key = "5" Then getKeys = 6
    ElseIf key = "6" Then getKeys = 7
    ElseIf key = "7" Then getKeys = 8
    ElseIf key = "8" Then getKeys = 9
    ElseIf key = "9" Then getKeys = 10
    ElseIf key = "0" Then getKeys = 11
    ElseIf key = "-" Then getKeys = 12
    ElseIf key = "=" Then getKeys = 13
    ElseIf key = "BACKSPACE" Then getKeys = 14
    ElseIf key = "TAB" Then getKeys = 15
    ElseIf key = "Q" Then getKeys = 16
    ElseIf key = "W" Then getKeys = 17
    ElseIf key = "E" Then getKeys = 18
    ElseIf key = "R" Then getKeys = 19
    ElseIf key = "T" Then getKeys = 20
    ElseIf key = "Y" Then getKeys = 21
    ElseIf key = "U" Then getKeys = 22
    ElseIf key = "I" Then getKeys = 23
    ElseIf key = "O" Then getKeys = 24
    ElseIf key = "P" Then getKeys = 25
    ElseIf key = "[" Then getKeys = 26
    ElseIf key = "]" Then getKeys = 27
    ElseIf key = "ENTER" Then getKeys = 28
    ElseIf key = "LCTRL" Then getKeys = 29
    ElseIf key = "A" Then getKeys = 30
    ElseIf key = "S" Then getKeys = 31
    ElseIf key = "D" Then getKeys = 32
    ElseIf key = "F" Then getKeys = 33
    ElseIf key = "G" Then getKeys = 34
    ElseIf key = "H" Then getKeys = 35
    ElseIf key = "J" Then getKeys = 36
    ElseIf key = "K" Then getKeys = 37
    ElseIf key = "L" Then getKeys = 38
    ElseIf key = ";" Then getKeys = 39
    ElseIf key = "'" Then getKeys = 40
    ElseIf key = "`" Then getKeys = 41
    ElseIf key = "LSHIFT" Then getKeys = 42
    ElseIf key = "\" Then getKeys = 43
    ElseIf key = "Z" Then getKeys = 44
    ElseIf key = "X" Then getKeys = 45
    ElseIf key = "C" Then getKeys = 46
    ElseIf key = "V" Then getKeys = 47
    ElseIf key = "B" Then getKeys = 48
    ElseIf key = "N" Then getKeys = 49
    ElseIf key = "M" Then getKeys = 50
    ElseIf key = "," Then getKeys = 51
    ElseIf key = "." Then getKeys = 52
    ElseIf key = "/" Then getKeys = 53
    ElseIf key = "RSHIFT" Then getKeys = 54
    ElseIf key = "NUMPAD*" Then getKeys = 55
    ElseIf key = "LALT" Then getKeys = 56
    ElseIf key = "SPACE" Then getKeys = 57
    ElseIf key = "CAPSLOCK" Then getKeys = 58
    ElseIf key = "F1" Then getKeys = 59
    ElseIf key = "F2" Then getKeys = 60
    ElseIf key = "F3" Then getKeys = 61
    ElseIf key = "F4" Then getKeys = 62
    ElseIf key = "F5" Then getKeys = 63
    ElseIf key = "F6" Then getKeys = 64
    ElseIf key = "F7" Then getKeys = 65
    ElseIf key = "F8" Then getKeys = 66
    ElseIf key = "F9" Then getKeys = 67
    ElseIf key = "F10" Then getKeys = 68
    ElseIf key = "NUMLOCK" Then getKeys = 69
    ElseIf key = "SCRLLOCK" Then getKeys = 70
    ElseIf key = "NUMPAD7" Then getKeys = 71
    ElseIf key = "NUMPAD8" Then getKeys = 72
    ElseIf key = "NUMPAD9" Then getKeys = 73
    ElseIf key = "NUMPAD-" Then getKeys = 74
    ElseIf key = "NUMPAD4" Then getKeys = 75
    ElseIf key = "NUMPAD5" Then getKeys = 76
    ElseIf key = "NUMPAD6" Then getKeys = 77
    ElseIf key = "NUMPAD+" Then getKeys = 78
    ElseIf key = "NUMPAD1" Then getKeys = 79
    ElseIf key = "NUMPAD2" Then getKeys = 80
    ElseIf key = "NUMPAD3" Then getKeys = 81
    ElseIf key = "NUMPAD0" Then getKeys = 82
    ElseIf key = "NUMPAD." Then getKeys = 83
    ElseIf key = "F14" Then getKeys = 84
    ElseIf key = "F15" Then getKeys = 85
    ElseIf key = "F13" Then getKeys = 86
    ElseIf key = "F11" Then getKeys = 87
    ElseIf key = "F12" Then getKeys = 88
    ElseIf key = "NUMPAD," Then getKeys = 91
    ElseIf key = "PAUSE" Then getKeys = 116
    ElseIf key = "NUMPADENTER" Then getKeys = 156
    ElseIf key = "RCTRL" Then getKeys = 157
    ElseIf key = "NUMPAD/" Then getKeys = 181
    ElseIf key = "SYSRQ" Then getKeys = 183
    ElseIf key = "RALT/" Then getKeys = 184
    ElseIf key = "HOME" Then getKeys = 181
    ElseIf key = "UP" Then getKeys = 199
    ElseIf key = "PAGE UP" Then getKeys = 200
    ElseIf key = "LEFT" Then getKeys = 203
    ElseIf key = "RIGHT" Then getKeys = 205
    ElseIf key = "END" Then getKeys = 207
    ElseIf key = "DOWN" Then getKeys = 208
    ElseIf key = "PAGE DN" Then getKeys = 209
    ElseIf key = "DELETE" Then getKeys = 211
    ElseIf key = "LWIN" Then getKeys = 219
    ElseIf key = "RWIN" Then getKeys = 220
    ElseIf key = "APPS" Then getKeys = 221
    End If
End Function

Private Sub tau()
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "Data Required"
        Exit Sub
    End If
    preFormLoad
    Load frmPassenger
    frmPassenger.Show
End Sub

Private Sub timatic()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    preFormLoad
    Load frmVisaHealth
    frmVisaHealth.Show
End Sub
Private Sub airAvail()
    Dim objVP As Viewpoint.ViewpointSrv
    Dim objVP3 As Viewpoint.ViewpointSrv3
    Dim fso As FileSystemObject
    Dim fil As File
    Dim ts As TextStream
    Dim i As Integer
    Dim strFile As String
    Dim strContent As String
    Dim bolAirSegExist As Boolean
    Dim strProcessKey As String
    
    findFPWindow
    preFormLoad
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    
    If (gstrCurrentPNR <> gobjPNR.RecLoc And gstrCurrentPNR <> "") Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
    
    pStartProcessTimeLog gconModAir, gconSModAvail, "VPAVAIL", "Avail", "AIR SELL", gstrProcessGrpID

    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    
    Set objVP = New Viewpoint.ViewpointSrv
    Set objVP3 = New Viewpoint.ViewpointSrv3
    Set objVPlistener = New VIEWPOINTLISTENERLib.ListenerObj
    Set fso = CreateObject("Scripting.FileSystemObject")
    strFile = "./XMLFiles/AirAvailSearch.xml"
    strContent = ""
    bolAirSegExist = False
    objVP.RetrieveCurrentPNR
    
    If Dir$(strFile) <> "" Then
       Set fil = fso.GetFile(strFile)
       Set ts = fil.OpenAsTextStream(ForReading)
       strContent = ts.ReadAll
       ts.Close
       'For i = 1 To gobjPNR.AirSegCount
       '    With gobjPNR.AirSeg(i)
       '         If .Flown = False Then
       '            bolAirSegExist = True
       '            strContent = Replace(strContent, "AVAILDATE", Format(.DepartDateTime, "mm/dd"))
       '            strContent = Replace(strContent, "DEPCITY", .DepartAirport)
       '            strContent = Replace(strContent, "ARRCITY", .ArriveAirport)
                   'strContent = Replace(strContent, "AVAIRLINE", .Vendor)
                   'strContent = Replace(strContent, "LFS_EARLIEST_TIME", _
                   '             IIf(Format(.DepartDateTime, "hh:nn AM/PM") >= "12:00 AM" And Format(.DepartDateTime, "hh:nn") <= "02:00 AM", "12:00 AM", Format(DateAdd("h", -2, .DepartDateTime), "hh:nn AM/PM")))
                   'Exit For
       '         End If
       '    End With
       'Next
    End If
    
    If bolAirSegExist = False Then strContent = ""

    objVP3.AirSearchAvail strContent, False
    
    
   'Dim oldParent As Long
    Dim hwnd As Long
  'Dim VPToolbarHwnd As Long
       'Call EnumChildWindows(glngTargetHwnd, AddressOf EnumChildWindowProc, 0&)
    'Find the handler of focal point window to solve the problem of hanging issue when calling Viewpoint screen
   ' VPToolbarHwnd = FindWindowEx(VPHwnd, ByVal 0&, "AfxControlBar70", vbNullString)
    'hwnd = FindWindowEx(VPToolbarHwnd, ByVal 0&, "#32770", vbNullString)
   ' oldParent = SetParent(hwnd, VPToolbarHwnd)
    'DoEvents
    'oldParent = SetParent(hwnd, glngTargetHwnd)
    'DoEvents
    
   'VPHwnd = IsAppRunning("Galileo Desktop")
       
    
    'Find the handler of Galileo Desktop Custom Toolbar to place the TPro toolbar
    'VPToolbarHwnd = FindWindowEx(VPHwnd, ByVal 0&, "AfxControlBar70", vbNullString)
    'a = FindWindow(vbNullString, txtWindowTitle)
    'If a <> 0 Then SetWinOnTop = SetWindowPos(a, HWND_TOPMOST, 0, 0, 0, 0, flags)
    
    'WindowHandle a, 1
    'hWnd = FindWindowWild("Air Availability*", False)
    'hwnd = FindWindowEx(gVPMDIHwnd, ByVal 0&, "FocalpointTerminalMDIFrame", vbNullString)
    
End Sub
Private Sub lowFareShop()
    Dim objVP As Viewpoint.ViewpointSrv
    Dim objVP3 As Viewpoint.ViewpointSrv3
    Dim fso As FileSystemObject
    Dim fil As File
    Dim ts As TextStream
    Dim i As Integer
    Dim strFile As String
    Dim strContent As String
    Dim bolAirSegExist As Boolean
    Dim strProcessKey As String
    
    findFPWindow
    
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    
    If (gstrCurrentPNR <> gobjPNR.RecLoc And gstrCurrentPNR <> "") Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
    pStartProcessTimeLog gconModAir, gconSModShop, "VPAVAIL", "Shop", "AIR SELL", gstrProcessGrpID

    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    
    Set objVP = New Viewpoint.ViewpointSrv
    Set objVP3 = New Viewpoint.ViewpointSrv3
    Set objVPlistener = New VIEWPOINTLISTENERLib.ListenerObj
    Set fso = CreateObject("Scripting.FileSystemObject")
    strFile = "./XMLFiles/LowFareShop.xml"
    strContent = ""
    bolAirSegExist = False
    objVP.RetrieveCurrentPNR
    
    If Dir$(strFile) <> "" Then
       Set fil = fso.GetFile(strFile)
       Set ts = fil.OpenAsTextStream(ForReading)
       strContent = ts.ReadAll
       ts.Close
       For i = 1 To gobjPNR.AirSegCount
           With gobjPNR.AirSeg(i)
                If .Flown = False Then
                   bolAirSegExist = True
                   strContent = Replace(strContent, "LFS_DEP_DATE", Format(.DepartDateTime, "mm/dd"))
                   strContent = Replace(strContent, "LFS_DEP_CITY", .DepartAirport)
                   strContent = Replace(strContent, "LFS_ARR_CITY", .ArriveAirport)
                   strContent = Replace(strContent, "LFS_DEP_TIME", Format(.DepartDateTime, "hh:nn AM/PM"))
                   strContent = Replace(strContent, "LFS_EARLIEST_TIME", _
                                IIf(Format(.DepartDateTime, "hh:nn AM/PM") >= "12:00 AM" And Format(.DepartDateTime, "hh:nn") <= "02:00 AM", "12:00 AM", Format(DateAdd("h", -2, .DepartDateTime), "hh:nn AM/PM")))
                   
                End If
           End With
       Next
    End If
    
    If bolAirSegExist = False Then strContent = ""
    'Open low fare shop with the xml data populated
    objVP3.lowFareShop strContent, False

End Sub

Private Sub quoteFile()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    preFormLoad
    'If isLoaded("frmFareQuoteRequest") = True Then
    '    frmFareQuoteRequest.WindowState = vbNormal
    'Else
        Load frmFareQuoteRequest
    'End If
    frmFareQuoteRequest.Show
End Sub

Private Sub pretrip()

    Dim strMsg As String

    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If

    If CheckPreTrip = True Then
        preFormLoad
        Load frmPreTrip
        frmPreTrip.Show
    Else
        strMsg = "No PreTrip MI required for this Client"
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - No Data Required"
    End If
    
End Sub

Private Sub fareDiff()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    preFormLoad
    If isLoaded("frmFareDiff") = True Then
        frmFareDiff.WindowState = vbNormal
    Else
        Load frmFareDiff
    End If
    frmFareDiff.Show
End Sub

Private Sub queuePNR()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    'ZhiSam - V1.2.24 20140116 - CR 304 - JTB Integration - AgencyName Error Checking
    If bolAgencyNameCheck(gobjPNR.CompInfo.AgencyName) = False Then
        Exit Sub
    End If
    '--
    
    preFormLoad
   ' If isLoaded("frmTktQueue") = True Then
   ' frmTktQueue.WindowState = vbNormal
    
   ' frmTktQueue.Show
   ' Else

    Load frmTktQueue
    frmTktQueue.Show
   ' End If
End Sub
Private Sub Rmk()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    preFormLoad
    'If isLoaded("frmTktInfo") Then
    '    frmTktInfo.WindowState = vbNormal
    'Else
        Load frmAddLine
    'End If
    frmAddLine.Show
End Sub
Private Sub issueDocs()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    preFormLoad
    'If isLoaded("frmTktInfo") Then
    '    frmTktInfo.WindowState = vbNormal
    'Else
        Load frmTktInfo
    'End If
    frmTktInfo.Show
End Sub

Private Sub sellCar()
    findFPWindow
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    preFormLoad
    Load frmCarSellRequest
    frmCarSellRequest.Show
End Sub

Private Sub carMI()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    preFormLoad
    
    If gobjPNR.CompInfo.MI = True Then
        gstrProductType = "CX"
        Load frmCarRmkMI
        frmCarRmkMI.Show
    Else
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "MI is not require for this client - " & gobjPNR.CompInfo.ProfileName, vbOKOnly + vbDefaultButton1, "CWT Desktop - Information"

    End If
End Sub

Private Sub sellHotel()
    findFPWindow
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    preFormLoad
    Load frmHotelSellRequest
    frmHotelSellRequest.Show
End Sub

Private Sub HtlMI()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    preFormLoad
    If gobjPNR.CompInfo.MI = True Then
        gstrProductType = "HL"
        Load frmCarRmkMI
        frmCarRmkMI.Show
    Else
         modMsgBox.OKMsg = "OK"
         modMsgBox.sMsgBox gVPMDIHwnd, "MI is not require for this client - " & gobjPNR.CompInfo.ProfileName, vbOKOnly + vbDefaultButton1, "CWT Desktop - Information"

    End If
End Sub

Private Sub openDespatchExe()
    Dim strMsg As String
    Dim datFormLoadStart As Date
    
    On Error GoTo despath_err
    datFormLoadStart = Now
     If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
    If gstrDespatchExe <> "" Then
       Shell gstrDespatchExe
       
           
       pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
       gconModMisc, frmSideBar.cmbSelectType.Text, gconSModDespatch, _
       Me.Name, gconFormLoad, gstrProcessGrpID, , datFormLoadStart

       
    Else
       strMsg = "Despatch Program Path not found."
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
    End If
    
    Exit Sub
despath_err:
    strMsg = "No Despatch Program found."
    modMsgBox.OKMsg = "OK"
    modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
    gobjLog.ErrorToLog Err.Source, Err.Number, Err.Description & "No depatch program found: " & "DespatchPath:" & gstrDespatchExe
End Sub

Private Sub DespVisaUpdate()
    Dim strMsg As String
    
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    preFormLoad
    
    On Error GoTo ErrorProc
    
    Set gdbDespatch = New ADODB.Connection
    
    If gstrDespatch <> "" Then
       gdbDespatch.ConnectionString = gstrDespatch
       gdbDespatch.Open
       frmDespDI.Show
    Else
       strMsg = "Error in despatch database connect string!"
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
    End If
    
    Exit Sub

ErrorProc:
    Select Case Err.Number
           Case 3044, 3024
                strMsg = "The database cannot be found" & vbCrLf & _
                        "Error Code: " & Err.Number & vbCrLf & Err.Description & vbCrLf & vbCrLf & _
                        CstrErrorAdvice
                modMsgBox.OKMsg = "OK"
                modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
           Case Else
                strMsg = "There is a problem with the database" & vbCrLf & _
                        "Error Code: " & Err.Number & vbCrLf & Err.Description & vbCrLf & vbCrLf & _
                        CstrErrorAdvice
                modMsgBox.OKMsg = "OK"
                modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
    End Select

End Sub

Private Sub sendLTT()
    
    Dim bolSkipTktCheck As Boolean
    Dim strSQL As String
    Dim rs As ADODB.Recordset
    Dim lngID As Long
    Dim strQPCC As String
    Dim intQNum As Integer
    Dim strQCat As String
    Dim intAns As Integer
    Dim strRes As String
    Dim strMsg As String
    Dim strCon As String
    Dim datFormLoadStart As Date
    
    Dim strOptionValue As String
    
    datFormLoadStart = Now
    If gstrCurrentPNR <> gobjPNR.RecLoc Or gstrProcessGrpID = "" Then gstrProcessGrpID = pGetProcessKey
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    preFormLoad
    
    strMsg = "Would you like to force sending LTT reminder?"
    modMsgBox.YESMsg = "Yes"
    modMsgBox.NOMsg = "No"
    intAns = modMsgBox.sMsgBox(gVPMDIHwnd, strMsg, vbQuestion + vbApplicationModal + vbYesNo + vbDefaultButton2, "CWT Desktop")
    
    If intAns = vbNo Then Exit Sub
    bolSkipTktCheck = NPExist(gconSkipChkTktQualifier, gconSkipChkTkt)
    If bolSkipTktCheck = False Then
       gobjHost.terminalEntry "NP." & gconSkipChkTktQualifier & "*" & gconSkipChkTkt
    End If
    
    '--Do not require
'    strCon = "LTT " & gstrAgcyCountryCode
'    strSQL = "Select ConditionID from [v_QMgrCon] "
'    strSQL = strSQL & "Where ConditionName = '" & strCon & "' "
'
'    RunSQLCommand SQLType.Select_, strSQL, gdbConn, rs
'    If rs.EOF = False Then
'       lngID = rs!ConditionID
'    Else
'       strMsg = "Unable to send LTT, 'LTT SG' not in tblCondition, please contact IT"
'       modMsgBox.OKMsg = "OK"
'       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
'       rs.Close
'       Set rs = Nothing
'       Exit Sub
'    End If
'    rs.Close
'    Set rs = Nothing
'
'    strSQL = "Select * from [v_QMgrConQTo] "
'    strSQL = strSQL & "Where ConditionID = " & lngID & " "
'    RunSQLCommand SQLType.Select_, strSQL, gdbConn, rs
'    If rs.EOF = False Then
'       strQPCC = rs!QPCC & ""
'       intQNum = rs!QNum
'       strQCat = rs!QCat & ""
'    Else
'       strMsg = "Unable to send LTT, ConditionID " & lngID & " not in tblConQueueTo, please contact IT"
'       modMsgBox.OKMsg = "OK"
'       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
'       rs.Close
'       Set rs = Nothing
'       Exit Sub
'    End If
'    rs.Close
'    Set rs = Nothing
'
'    strRes = gobjHost.terminalEntry("QEB/" & strQPCC & "/" & intQNum & IIf(strQCat = "", "", "*C" & strQCat))
'    If Mid(strRes, 1, 8) = "ON QUEUE" Then
'       strMsg = "PNR has been succesfully queued to LTT" & vbCrLf & "Please retrieve the PNR if you want to continue work with the PNR"
'       modMsgBox.OKMsg = "OK"
'       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop"
'    Else
'       strMsg = "Unable to queue to LTT!" & vbCrLf & "Response:" & vbCrLf & strRes
'       modMsgBox.OKMsg = "OK"
'       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
'    End If
'
'       pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
'       gconModMisc, frmSideBar.cmbSelectType.Text, gconSModLTT, _
'       Me.Name, gconProcessing, gstrProcessGrpID, , datFormLoadStart
    '--Do not require
    
    'ZhiSam - V1.2.24 20140116 - CR 304 - JTB Integration - Take data from TPro instead of queue manager database
    strSQL = "Select [OptionValue] from [tblModOptions] Where [OptionCode] = 'LTT'"
   
    RunSQLCommand SQLType.Select_, strSQL, gdbConn, rs
    
    If rs.EOF = False Then
       strOptionValue = rs!optionvalue
    Else
       strMsg = "Unable to send LTT, 'LTT' not in tblModOptions, please contact IT"
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
       rs.Close
       Set rs = Nothing
       Exit Sub
    End If
    rs.Close
    Set rs = Nothing

    gobjHost.terminalEntry "R.LTT"
    strRes = gobjHost.terminalEntry("QEB/" & strOptionValue)
    If Mid(strRes, 1, 8) = "ON QUEUE" Then
       strMsg = "PNR has been succesfully queued to LTT" & vbCrLf & "Please retrieve the PNR if you want to continue work with the PNR"
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop"
    Else
       strMsg = "Unable to queue to LTT!" & vbCrLf & "Response:" & vbCrLf & strRes
       modMsgBox.OKMsg = "OK"
       modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Error"
    End If
    
       pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, _
       gconModMisc, frmSideBar.cmbSelectType.Text, gconSModLTT, _
       Me.Name, gconProcessing, gstrProcessGrpID, , datFormLoadStart
   '---
End Sub

Private Sub raiseCheque()
   frmPassword.Show
   preFormLoad
End Sub

Private Sub reprintEO()
   preFormLoad
   gbolReprintEO = True
   frmRaiseCheque.Show
   Do
     DoEvents
   Loop Until isLoaded("frmRaiseCheque") = False
   gbolReprintEO = False
End Sub

Private Sub auxilaryPdt()
    gbolMoveProfile = False
    If checkSignOn = False Then
       Exit Sub
    End If
    Set gobjPNR = New CWT_GalileoPNR3.PNR
    gobjPNR.loadPNR
    If gobjPNR.RecLoc = "" Then
        modMsgBox.OKMsg = "OK"
        modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "CWT Desktop - Data Required"
        Exit Sub
    End If
    'ZhiSam - V1.2.24 20140116 - CR 304 - JTB Integration
    If bolAgencyNameCheck(gobjPNR.CompInfo.AgencyName) = False Then
        Exit Sub
    End If
    '--
    preFormLoad
     If isLoaded("frmOthSvcs") = True Then
    frmOthSvcs.WindowState = vbNormal
    Else
    Load frmOthSvcs
    End If
    frmOthSvcs.Show
End Sub

Private Sub objVPlistener_OnViewpointEvent(ByVal EventStr As String)
   
   Dim mxmldomEvent As MSXML2.DOMDocument
   Dim strEventName As String
   Set mxmldomEvent = New MSXML2.DOMDocument
   
   
    'Debug.Print "Raw:" & vbCrLf & EventStr & vbCrLf
    mxmldomEvent.async = False
    If mxmldomEvent.loadXML(EventStr) = False Then Exit Sub
    If IsNull(mxmldomEvent.documentElement) = False And IsNull(mxmldomEvent.firstChild) = False Then
        strEventName = mxmldomEvent.documentElement.firstChild.nodeName
    End If
    'Debug.Print "EventName:" & strEventName
    'If strEventName = "AirCarrierAvailabilitySearch" Then
    '    gbolFPEnable = False
       ' Call EnumChildWindows(glngTargetHwnd, AddressOf EnumChildWindowProc, 0&)
    'End If
    'If strEventName = "SwitchedToFocalpoint" Or strEventName = "SellSummary" Or strEventName = "ViewChanged" Then
    '    gbolFPEnable = True
    '    Call EnumChildWindows(glngTargetHwnd, AddressOf EnumChildWindowProc, 0&)
    'End If
    If strEventName = "SwitchedToFocalpoint" Then
        'gbolFPEnable = True
        Call EnumChildWindows(glngTargetHwnd, AddressOf EnumChildWindowProc, 0&)
    End If
    
    
    If strEventName = "AirSell" Then
        pEndProcessTimeLog IIf(gobjPNR.CN <> "", gobjPNR.CN, ""), frmSideBar.cmbSelectReq.Text, gconModAir, frmSideBar.cmbSelectType.Text, gstrProcess, gstrForm, gstrSubProcess, gstrProcessGrpID
        'pResetStartTime
    End If
    
    If strEventName = "AirSell" Or strEventName = "CancelledSegment" Then
        pDisplayToFP ("*R")
    End If
    
End Sub

Function CheckPreTrip()

    Dim strSQL As String
    Dim rsMI As ADODB.Recordset

    'Check if there's any Pretrip MI, if no then do nothing
    strSQL = "Select a.*, b.Format from tblClientMI a, tblMICategory b Where a.CN='" & gobjPNR.CN & "' AND a.location = b.code AND a.location = '3' Order by FF"
    Set rsMI = gdbConn.Execute(strSQL)

    'CheckPreTrip True means there are PreTrip MI to be entered
    If rsMI.EOF = False Then
        CheckPreTrip = True
    Else
        CheckPreTrip = False
    End If

    Set rsMI = Nothing

End Function

'JY - V1.2.3 20110318 - CR52 - Change to include Hotel Booking Tool in the process
Private Sub callHBT()
   Load frmWebSite
   frmWebSite.Show
   frmWebSite.openWebsite ("HBT")
End Sub
'Preethi - 20110704  - Tracking of Touches to CWT Booking
Private Sub TrackingTouches()
     If checkSignOn = True Then
       If gobjPNR Is Nothing = False Then
           strResponse = gobjHost.terminalEntry("*R")
           If InStr(1, strResponse, "NO B.F. TO DISPLAY - CREATE OR RETRIEVE FIRST") > 0 Then
              MsgBox "PNR is required...", vbOKOnly, "Tracking Touches - Error"
           Else
              If gobjPNR.CompInfo.PNRTrackingTouches = True Then
                 frmPNRTouchTracking.cmdCancel.Enabled = True
                 frmPNRTouchTracking.Skinner1.CloseButton = skyes
                 Load frmPNRTouchTracking
                 frmPNRTouchTracking.Show
              Else
                 MsgBox "This client is not set up for the tracking program." & vbCrLf & "Please contact the TPRO administrator for set up", vbOKOnly, "Tracking Touches - Error"
              End If
           End If
        End If
      End If
      
End Sub
'Preethi - V1.2.8  20111031 - CR101 - Aqua Itin Remark Screen
Private Sub AquaItinRmk()

Dim strError As String

     If checkSignOn = True Then
       If gobjPNR Is Nothing = False Then
           strResponse = gobjHost.terminalEntry("*R")
           If InStr(1, strResponse, "NO B.F. TO DISPLAY - CREATE OR RETRIEVE FIRST") > 0 Then
              modMsgBox.OKMsg = "OK"
              modMsgBox.sMsgBox gVPMDIHwnd, "PNR is required...", vbOKOnly + vbDefaultButton1, "Aqua Itin Remark - Data Required"
           Else
              If gobjPNR.CompInfo.AquaItin = True Then
                 gbolMoveProfile = False
                 Load frmAquaItinRmk
                 frmAquaItinRmk.Show
              Else
                 strError = "This client is not set up for the Aqua Itin program." & vbCrLf & "Please contact the TPRO administrator for set up"
                 modMsgBox.OKMsg = "OK"
                 modMsgBox.sMsgBox gVPMDIHwnd, strError, vbOKOnly + vbDefaultButton1, "Aqua Itin Remark - Error"
              End If
           End If
        End If
      End If
      
End Sub

Private Sub cmbDatabase_Click()
    
    'JY - V1.2.6 20110916 - CR109 - Startup form for users to select database to be connected (AU ESC)
    Dim strCountry As String
    
    If cmbDatabase.listindex = 0 Then
       strCountry = "SG"
    ElseIf cmbDatabase.listindex = 1 Then
       strCountry = "HK"
    End If
    
    If strCountry <> gstrDatabaseConnected Then
       gstrDatabaseConnected = strCountry
       timerUnload.Enabled = True
    End If
    
End Sub

Private Sub timerUnload_Timer()
    
    'JY - V1.2.6 20110916 - CR109 - Startup form for users to select database to be connected (AU ESC)
    'Need to use the timer to unload the form because frmBar is not able to be unloaded in the click event
    timerUnload.Enabled = False
    'Close all forms, database connections and reset global variables before calling main function
    closeAll
    Main
    
End Sub

' ZhiSam - V1.3.1 - 20120917 - CR134 - SyEx Version : Create Rentention Line for Hotel Booking
Private Sub CreateRetentionLine()

Dim strResponse As String
Dim strMsg As String
 
 'if no air segment then create retention line
 gobjPNR.loadPNR
 
 If gobjPNR.AirSegCount = 0 And (bfunctCheckRTLine = False) Then
    'ZhiSam - V1.2.23 20130829 - CR-229 - Data Standardization Phase 1
    If gobjPNR.DSInfo.DSPhaseNum >= 1 Then
        gobjHost.terminalEntry ("RT.T/" & Format(DateAdd("d", 90, Date), "ddmmm") & "*")
    Else
        gobjHost.terminalEntry ("RT.T/" & Format(DateAdd("d", 90, Date), "ddmmm") & "*RETENTION LINE")
    End If
    
    gobjHost.terminalEntry ("T.TAU/" & Format(Now, "ddMMM"))
    gobjHost.terminalEntry ("R.HBU" & "/" & gobjHost.AgentSine)
    strResponse = gobjHost.terminalEntry("ER")

 ' if air segment exist
 Else
    gobjHost.terminalEntry ("T.TAU/" & Format(Now, "ddMMM"))
    gobjHost.terminalEntry ("R.HBU" & "/" & gobjHost.AgentSine)
    strResponse = gobjHost.terminalEntry("ER")
 End If
 
 If CheckResponse(strResponse, gstrPNRExpression, gintCheckERLineNum) = False Then
    For i = 0 To 1
        strResponse = gobjHost.terminalEntry("ER")
        If CheckResponse(strResponse, gstrPNRExpression, gintCheckERLineNum) = True Then
            Exit For
        End If
        'if fail to enter ER for three times, then prompt error message
        If i = 1 Then
            strMsg = "Unable to end PNR. Response from GDS is " & Chr(13) & strResponse
            strMsg = strMsg & Chr(13) & "System will continue without 'ER'."
            modMsgBox.OKMsg = "OK"
            modMsgBox.sMsgBox gVPMDIHwnd, strMsg, vbOKOnly + vbDefaultButton1, "CWT Desktop - Write to PNR"
        End If
    Next
 End If
 

End Sub
' ZhiSam - V1.2.17 20121015 - Smart Point and SyEx server selection
Private Sub CustomizeTabSyEx()

Dim i As Integer
Dim Index As Integer


    Index = SftSubTabs.Count
    For Index = 0 To SftSubTabs.Count - 1
        For i = 0 To SftSubTabs(Index).Tabs.Count - 1
            
            'Air Tab
            If Index = 0 Then
                'ZhiSam - V1.2.21 20130709 - CR 225 - Include Remark Tab in SyEx Environment (i=15)
                If i = 9 Or i = 11 Or i = 12 Or i = 13 Or i = 14 Or i = 15 Then
                    SftSubTabs(Index).Tab(i).Visible = True
                    SftSubTabs(Index).Tab(i).Enabled = True
                Else
                    SftSubTabs(Index).Tab(i).Visible = False
                    SftSubTabs(Index).Tab(i).Enabled = False
                End If
            
            'Hotel Tab
            ElseIf Index = 1 Then
                If i = 2 Or i = 3 Then
                    SftSubTabs(Index).Tab(i).Visible = True
                    SftSubTabs(Index).Tab(i).Enabled = True
                Else
                    SftSubTabs(Index).Tab(i).Visible = False
                    SftSubTabs(Index).Tab(i).Enabled = False
                End If
            
            'Car Tab
            ElseIf Index = 2 Then
                If i = 1 Or i = 2 Then
                    SftSubTabs(Index).Tab(i).Visible = True
                    SftSubTabs(Index).Tab(i).Enabled = True
                Else
                    SftSubTabs(Index).Tab(i).Visible = False
                    SftSubTabs(Index).Tab(i).Enabled = False
                End If
            
            'Other Services Tab
            ElseIf Index = 3 Then
                If i = 1 Or i = 2 Or i = 4 Then
                    SftSubTabs(Index).Tab(i).Visible = True
                    SftSubTabs(Index).Tab(i).Enabled = True
                Else
                    SftSubTabs(Index).Tab(i).Visible = False
                    SftSubTabs(Index).Tab(i).Enabled = False
                End If
            
            'Add-Ins Tool Tab
            ElseIf Index = 4 Then
                If i = 2 Then
                    SftSubTabs(Index).Tab(i).Visible = True
                    SftSubTabs(Index).Tab(i).Enabled = True
                Else
                    SftSubTabs(Index).Tab(i).Visible = False
                    SftSubTabs(Index).Tab(i).Enabled = False
                End If
            
            'Touch Tracking Tab
            ElseIf Index = 5 Then
                    SftSubTabs(Index).Tab(i).Visible = False
                    SftSubTabs(Index).Tab(i).Enabled = False
            
            'Aqua Itin Rmk Tab
            ElseIf Index = 6 Then
                    SftSubTabs(Index).Tab(i).Visible = False
                    SftSubTabs(Index).Tab(i).Enabled = False
            
            End If
        
        Next
    Next
    
End Sub
' ZhiSam - V1.2.19 20130311 - CR-203 - Desktop to Create Retention Line and Update TAW to TAU (SyEx with Tpro)
Private Sub functTAUupdate()

Dim strResponse As String
Dim strDate As String
Dim strType As String
Dim strMsgBox As String
Dim dDate As Date
Dim intRespMsgBox As Integer

strType = "TAW"
strType = UCase(strType)
'check TAW line

    ' ZhiSam - V1.2.20 20130528 - IR-54 - Bug Fix for Desktop to avoid simultaneous changes
     If gobjPNR.CheckPNRStatus = 3 Then
        gobjHost.terminalEntry "IR"
     End If
     
     gobjPNR.loadPNR
     strResponse = gobjPNR.TAWDate
     'strResponse = gobjHost.terminalEntry("*TD")
     If Len(strResponse) > 0 Then
        'If InStr(1, UCase(strResponse), strType) > 0 Then
                gbolUpdateTAUDate = False
                Load frmCalendar
                frmCalendar.Show

                Do
                    DoEvents
                Loop Until frmCalendar.Visible = False

                If gbolUpdateTAUDate = True Then
                    dDate = frmCalendar.MonthViewTAU.value
                    strDate = Format(dDate, "ddmmm")
                    strResponse = gobjHost.terminalEntry("T.@TAU/" & strDate)
                    strResponse = gobjHost.terminalEntry("R." & gobjHost.AgentSine)
                    strResponse = gobjHost.terminalEntry("ER")

                    If CheckResponse(strResponse, gstrPNRExpression, gintCheckERLineNum) = False Then
                       For i = 0 To 1
                           strResponse = gobjHost.terminalEntry("ER")
                           If CheckResponse(strResponse, gstrPNRExpression, gintCheckERLineNum) = True Then
                               Exit For
                           End If
                           'if fail to enter ER for three times, then prompt error message
                           If i = 1 Then
                               strResponse = "Unable to end PNR. Response from GDS is " & Chr(13) & strResponse
                               strResponse = strResponse & Chr(13) & "System will continue without 'ER'."
                               modMsgBox.OKMsg = "OK"
                               modMsgBox.sMsgBox gVPMDIHwnd, strResponse, vbOKOnly + vbDefaultButton1, "CWT Desktop - Write to PNR"
                           End If
                       Next
                    End If

                End If

                'Unload frmCalendar if frmCalendar is loaded
                If isLoaded(frmCalendar.Name) Then
                    Unload frmCalendar
                End If

           'Else
           '     Exit Sub
           'End If
     End If

End Sub

